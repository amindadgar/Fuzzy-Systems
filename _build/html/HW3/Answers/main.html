
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Homework #3 of Fuzzy Systems &#8212; Fuzzy Systems Course Exercises</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="Homework #1" href="../../HW1/main.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Fuzzy Systems Course Exercises</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../README.html">
                    Fuzzy-Systems
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../HW1/main.html">
   Homework #1
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Homework #3 of Fuzzy Systems
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/HW3/Answers/main.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/HW3/Answers/main.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fuzzy-inference-systems-and-fuzzy-controller">
   Fuzzy Inference Systems and Fuzzy Controller
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q1">
     Q1
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#answer">
       Answer
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q2">
     Q2
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Answer
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q3">
     Q3
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q4">
     Q4
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q5">
     Q5
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q6">
     Q6
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-driven-modeling">
   Data-Driven Modeling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q7">
     Q7
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q8">
     Q8
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#possibility-distribution">
   Possibility Distribution
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q9">
     Q9
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q10">
     Q10
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q11">
     Q11
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q12">
     Q12
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extended-operations-on-fuzzy-numbers">
   Extended operations on fuzzy numbers
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q13">
     Q13
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q14">
     Q14
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fuzzy-clustering">
   Fuzzy Clustering
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q15">
     Q15
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q16">
     Q16
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#part-a">
       Part a
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#part-b">
       Part b
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q17">
     Q17
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q18">
     Q18
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q19">
     Q19
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Homework #3 of Fuzzy Systems</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fuzzy-inference-systems-and-fuzzy-controller">
   Fuzzy Inference Systems and Fuzzy Controller
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q1">
     Q1
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#answer">
       Answer
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q2">
     Q2
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Answer
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q3">
     Q3
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q4">
     Q4
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q5">
     Q5
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q6">
     Q6
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-driven-modeling">
   Data-Driven Modeling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q7">
     Q7
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q8">
     Q8
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#possibility-distribution">
   Possibility Distribution
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q9">
     Q9
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q10">
     Q10
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q11">
     Q11
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q12">
     Q12
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extended-operations-on-fuzzy-numbers">
   Extended operations on fuzzy numbers
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q13">
     Q13
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q14">
     Q14
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fuzzy-clustering">
   Fuzzy Clustering
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q15">
     Q15
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q16">
     Q16
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#part-a">
       Part a
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#part-b">
       Part b
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q17">
     Q17
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q18">
     Q18
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#q19">
     Q19
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="homework-3-of-fuzzy-systems">
<h1>Homework #3 of Fuzzy Systems<a class="headerlink" href="#homework-3-of-fuzzy-systems" title="Permalink to this headline">#</a></h1>
<p><strong>Student name:</strong> Seyed Mohammad Amin Dadgar <br>
<strong>Student Id:</strong> 4003624016 <br>
<strong>Instructor:</strong> Dr. Hossein Karshenas <br></p>
<p><strong>Date:</strong> June, 2022 | Khordad, 1401</p>
<p>The questions are from the excersises of the books Fuzzy Set Theory — and Its Applications by H.J. Zimmerman <span class="math notranslate nohighlight">\(4^{th}\)</span> edition <span class="math notranslate nohighlight">\(2001\)</span> and fuzzy logic with engineering applications <span class="math notranslate nohighlight">\(4^{th}\)</span> edition <span class="math notranslate nohighlight">\(2017\)</span> by Dr Ross. We’ve specified the question numbers and the answers of it in this file.</p>
<center>
<h1>Table of contents</h1>
<h2> Fuzzy Inference Systems and Fuzzy Controller </h2>
<a href=#Q1>Question 1</a> <br>
<a href=#Q2>Question 2</a> <br>
<a href=#Q3>Question 3</a> <br>
<a href=#Q4>Question 4</a> <br>
<a href=#Q5>Question 5</a> <br>
<a href=#Q6>Question 6</a> <br>
<h2> Data-Driven Modeling</h2>
<a href=#Q7>Question 7</a> <br>
<a href=#Q8>Question 8</a> <br>
<h2>Possibility Distribution</h2>
<a href=#Q9>Question 9</a> <br>
<a href=#Q10>Question 10</a> <br>
<a href=#Q11>Question 11</a> <br>
<a href=#Q12>Question 12</a> <br>
<h2>Extended operations on fuzzy numbers</h2>
<a href=#Q13>Question 13</a> <br>
<a href=#Q14>Question 14</a> <br>
<h2>Fuzzy Clustering</h2>
<a href=#Q15>Question 15</a> <br>
<a href=#Q16>Question 16</a> <br>
<a href=#Q17>Question 17</a> <br>
<a href=#Q18>Question 18</a> <br>
<a href=#Q19>Question 19</a> <br>
</center>
<p>Libraries Used:</p>
<ul class="simple">
<li><p>matplotlib: This library is used for visualizations.</p></li>
<li><p>numpy: Numpy library helped us with arrays and mathematical calculations.</p></li>
<li><p>pandas: Used For creating a beautiful represetive of datas.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<section id="fuzzy-inference-systems-and-fuzzy-controller">
<h2>Fuzzy Inference Systems and Fuzzy Controller<a class="headerlink" href="#fuzzy-inference-systems-and-fuzzy-controller" title="Permalink to this headline">#</a></h2>
<section id="q1">
<h3>Q1<a class="headerlink" href="#q1" title="Permalink to this headline">#</a></h3>
<p>Answer to the question 6 of chapter 9 of the Zimmerman book.</p>
<p>Let the universe <span class="math notranslate nohighlight">\(X=\{1, 2, 3, 4, 5\}\)</span> and “small integers” represented as a fuzzy set <span class="math notranslate nohighlight">\(\tilde{A}=\{(1, 1), (2, .5), (3, .4), (4, .2)\}.\)</span></p>
<p>Having the Fuzzy relation “Almost Equal” as below
<img alt="image.png" src="HW3/Answers/attachment:image.png" />
Find the fuzzy set “rather small integers” using the composition <span class="math notranslate nohighlight">\(\tilde{B}=\tilde{A} o \tilde{R}\)</span></p>
<section id="answer">
<h4>Answer<a class="headerlink" href="#answer" title="Permalink to this headline">#</a></h4>
<p>If we assume the composition as a <code class="docutils literal notranslate"><span class="pre">max-min</span></code> operation, we can find the answer of the <span class="math notranslate nohighlight">\(\tilde{A} o \tilde{R}\)</span> as below
\begin{equation}
\tilde{B} = \tilde{A} o \tilde{R} = {(1, 1), (2, .8), (3, .5), (4, .4)}
\end{equation}</p>
</section>
</section>
<section id="q2">
<h3>Q2<a class="headerlink" href="#q2" title="Permalink to this headline">#</a></h3>
<p>Answer to the question 12 of chapter 5 in the Ross book.</p>
<p>Considering the universe set X=[0,9].</p>
<p>Having <span class="math notranslate nohighlight">\(\tilde{A}={(0, 0.4), (1, 0.7), (2, 0.2), (3, 0.1), (4, 0.3)}\)</span> and <span class="math notranslate nohighlight">\(\tilde{B}={(5, 0), (6, 0.5), (7, 0.6), (8, 0.3), (9, 0.7)}\)</span>.</p>
<ul class="simple">
<li><p>Part b. Construct the rule <strong><span class="math notranslate nohighlight">\(\tilde{R}\)</span> = If <span class="math notranslate nohighlight">\(\tilde{A}\)</span> then <span class="math notranslate nohighlight">\(\tilde{B}\)</span></strong> using Mamdani implication.</p></li>
<li><p>Part c. having the new antecedent <span class="math notranslate nohighlight">\(\tilde{A} = \{(0, .3), (1, .7), (2, .6), (3, .3), (4, .5) \}\)</span> find the new consequent <span class="math notranslate nohighlight">\(\tilde{B}^{'}\)</span>.</p></li>
</ul>
<section id="id1">
<h4>Answer<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h4>
<p>We can find the <span class="math notranslate nohighlight">\(\mu_{\tilde{R}} = min\{\mu_{\tilde{A}}, \mu_{\tilde{B}}\}\)</span> as a matrix below
<img alt="image.png" src="HW3/Answers/attachment:image.png" /></p>
<p>And to find the <span class="math notranslate nohighlight">\(\tilde{B}^{'}\)</span>, we can find the answer using the Mamdani implication rule(<code class="docutils literal notranslate"><span class="pre">max-min</span></code> operation will be applied on <span class="math notranslate nohighlight">\(\tilde{R}\)</span>). We will write the computations for one of the values <code class="docutils literal notranslate"><span class="pre">0</span></code>, and the others are the same and we will calculate it without writing (using mind).</p>
<p>Calculation:
\begin{equation}
\mu_{\tilde{B}^{‘}}(0) = max{min{0.3, 0}, min{0.7, 0}, min{0.3, 0}, min{0.3, 0}, min{0.5, 0}} = max{0,0 , 0, 0, 0} = 0
\end{equation}
So to answer for all values of <span class="math notranslate nohighlight">\(X\)</span> is as below
\begin{equation}
\tilde{B}^{’} = {(5, 0), (6, 0.5), (7, 0.6), (8, 0.3), (9, 0.7)}
\end{equation}</p>
</section>
</section>
<section id="q3">
<h3>Q3<a class="headerlink" href="#q3" title="Permalink to this headline">#</a></h3>
<p>Answer to the question 15 of chapter 5, using the Ross book.</p>
<p>\begin{equation}
\mu_{\tilde{H}}(x) = {(10, .7), (20, .6), (30, .3), (40, .4), (50, .2)} \
\mu_{\tilde{D}}(y) = {(5<em>10^4, .8), (10</em>10^4, .5), (15<em>10^4, .6), (20</em>10^4, .4), (15*10^4, .1)}
\end{equation}</p>
<ul class="simple">
<li><p>Part a.Using the classical implication <code class="docutils literal notranslate"><span class="pre">min</span></code> operator find the asnwer to the rule <strong>If high water level (H) THEN more discharge (D)</strong>
<img alt="image.png" src="HW3/Answers/attachment:image.png" /></p></li>
<li><p>Part b. Using the <code class="docutils literal notranslate"><span class="pre">max-min</span></code> composition find the discharge associated with this level of water <span class="math notranslate nohighlight">\(\mu_{\tilde{H}}^{'} = \{(10, .7),(20, .3), (30, .5), (40, .6), (50, .4)\}\)</span>.</p></li>
</ul>
<p>The answer is
\begin{equation}
\mu_{\tilde{D}}^{’} = {(5<em>10^4, 0.7), (10</em>10^4, 0.5), (15<em>10^4, 0.6), (20</em>10^4, 0.4), (25*10^4, 0.1)}
\end{equation}</p>
</section>
<section id="q4">
<h3>Q4<a class="headerlink" href="#q4" title="Permalink to this headline">#</a></h3>
<p>Answer to the question 26 of chapter 5, using the Ross book.</p>
<p>Having the values below as input, Apply Mamdani and a Sugeno inference using the membership functions and the rules.</p>
<p><strong>Inputs</strong>
\begin{equation}
Re = 1.965 \times 10^4 \
Pr = 275
\end{equation}
<strong>Rules</strong>
\begin{equation}
A. \text{If Re is high and Pr is low Then Nu is low.} \
B. \text{If Re is low and Pr is low Then Nu is low.} \
C. \text{If Re is high and Pr is high Then Nu is medium.} \
D. \text{If Re is low and Pr is high Then Nu is medium.}
\end{equation}
<strong>Membership Functions</strong>
<img alt="image.png" src="HW3/Answers/attachment:image.png" /></p>
<p>Computing the <code class="docutils literal notranslate"><span class="pre">Low</span></code> membership value for <em>Re</em> gaves us <span class="math notranslate nohighlight">\(\mu_{RE, Low}(1.965 \times 10^4) = 0.25\)</span> <br>
Computing the <code class="docutils literal notranslate"><span class="pre">High</span></code> membership value for <em>Re</em> gaves us <span class="math notranslate nohighlight">\(\mu_{RE, High}(1.965 \times 10^4) = 0.25\)</span> <br></p>
<p>Computing the <code class="docutils literal notranslate"><span class="pre">Low</span></code> membership value for <em>Pr</em> gaves us <span class="math notranslate nohighlight">\(\mu_{Pr, Low}(275) = 0.75\)</span> <br>
Computing the <code class="docutils literal notranslate"><span class="pre">High</span></code> membership value for <em>Pr</em> gaves us <span class="math notranslate nohighlight">\(\mu_{Pr, High}(275) = 0.2\)</span> <br></p>
<p>Note: the values for each one is near accurate, because we’re finding the membership values by look.</p>
<p>Using the values above we can Find the membership values to each rule
\begin{equation}
\text{Rule A.} \mu_{Nu, Low} = min{0.25, 0.75} = 0.25 \
\text{Rule B.} \mu_{Nu, Low} = min{0.25, 0.75} = 0.25 \
\text{Rule C.} \mu_{Nu, Medium} = min{0.25, 0.2} = 0.2 \
\text{Rule D.} \mu_{Nu, Medium} = min{0.25, 0.2} = 0.2
\end{equation}
And the membership values for <span class="math notranslate nohighlight">\(\mu_{Nu, big}\)</span> is zero.</p>
<p>So the output of Mamdani equation is as below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">375</span><span class="p">,</span> <span class="mi">575</span><span class="p">,</span> <span class="mi">201</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">525</span><span class="p">,</span> <span class="mi">725</span><span class="p">,</span> <span class="mi">201</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>


<span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">201</span><span class="p">),</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">201</span><span class="p">),</span> <span class="mf">0.25</span><span class="p">)</span>

<span class="c1">## note: values are near accurate</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x1</span> <span class="o">&lt;=</span> <span class="mi">400</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="mi">375</span><span class="p">),</span> <span class="n">y1</span><span class="p">)</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x1</span> <span class="o">&gt;=</span> <span class="mi">550</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="mi">575</span><span class="p">),</span> <span class="n">y1</span><span class="p">)</span>

<span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x2</span> <span class="o">&lt;=</span> <span class="mi">525</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="mi">525</span><span class="p">),</span> <span class="n">y2</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x2</span> <span class="o">&gt;=</span> <span class="mi">700</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="mi">725</span><span class="p">),</span> <span class="n">y2</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;$Nu = Medium$&#39;</span><span class="p">,</span> <span class="s1">&#39;$Nu = Low$&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/main_20_0.png" src="../../_images/main_20_0.png" />
</div>
</div>
<p>The sugeno inference would gives us the equation below for the result of inference</p>
<p>\begin{equation}
\frac{0.25(475) + 0.2 (475) + 0.2(625) + 0.2(625)}{0.25 + 0.2 + 0.2 + 0.2} = \frac{463.75}{0.85} = 545.59
\end{equation}</p>
</section>
<section id="q5">
<h3>Q5<a class="headerlink" href="#q5" title="Permalink to this headline">#</a></h3>
<p>Answer to the question 3 of chapter 11, using the Zimmerman book.</p>
<p>Using the rule base system below, (a) Apply Mamdani implication on <code class="docutils literal notranslate"><span class="pre">error=2</span></code> and <code class="docutils literal notranslate"><span class="pre">change</span> <span class="pre">of</span> <span class="pre">error</span> <span class="pre">=</span> <span class="pre">4</span></code>. (b) Then using two methods <code class="docutils literal notranslate"><span class="pre">MOM</span></code> and <code class="docutils literal notranslate"><span class="pre">COG</span></code>.
<img alt="image.png" src="HW3/Answers/attachment:image.png" /></p>
<p><strong>Answer</strong></p>
<p>First we will try to plot each fuzzy rule membership values.</p>
<p>Error membership function is as below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_rules</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">161</span><span class="p">)</span>
<span class="c1">## the plot for `error` is as below</span>
<span class="c1">## constructing a plot for each granule</span>

<span class="c1">## for negative, we have `1` and the equation `-1/2 (x+1)`</span>
<span class="n">negative_error</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">X_rules</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">negative_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X_rules</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">negative_error</span><span class="p">)</span>
<span class="n">negative_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">negative_error</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">negative_error</span><span class="p">)</span>

<span class="c1">## for zero granule, we have the equations `-1/3 (x-3)` for right expansion</span>
<span class="c1">## And `-1/3 (x+3)` for the left expansion</span>

<span class="c1">## right expansion</span>
<span class="n">zero_error</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">X_rules</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="c1">## left expansion</span>
<span class="n">zero_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X_rules</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span> <span class="p">(</span><span class="n">X_rules</span><span class="o">+</span><span class="mi">3</span><span class="p">),</span> <span class="n">zero_error</span><span class="p">)</span>
<span class="c1">## zero ing for other values</span>
<span class="n">zero_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">X_rules</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">X_rules</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">zero_error</span><span class="p">)</span>

<span class="c1">## for positive granule, the left expansion equation is `1/2 (x-1)`</span>
<span class="c1">## And the right expansion equation is `1` </span>

<span class="n">positive_error</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">X_rules</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">positive_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X_rules</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">positive_error</span><span class="p">)</span>
<span class="n">positive_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X_rules</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">positive_error</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_rules</span><span class="p">,</span> <span class="n">negative_error</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_rules</span><span class="p">,</span> <span class="n">zero_error</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_rules</span><span class="p">,</span> <span class="n">positive_error</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$\mu(error)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="mi">8</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="s2">&quot;Error Memeberhip&quot;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;negative&#39;</span><span class="p">,</span> <span class="s1">&#39;zero&#39;</span><span class="p">,</span> <span class="s1">&#39;positive&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/main_25_0.png" src="../../_images/main_25_0.png" />
</div>
</div>
<p>Change of error is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_rules</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">161</span><span class="p">)</span>
<span class="c1">## the plot for `error` is as below</span>
<span class="c1">## constructing a plot for each granule</span>

<span class="c1">## for negative, we have `1` and the equation `-1/4 (x+1)`</span>
<span class="n">negative_change_error</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="n">X_rules</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">negative_change_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X_rules</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">negative_change_error</span><span class="p">)</span>
<span class="n">negative_change_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">negative_change_error</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">negative_change_error</span><span class="p">)</span>

<span class="c1">## for zero granule, we have trapezoidal</span>
<span class="c1">## the equations: </span>
<span class="c1">##   `(x-3)` for right expansion</span>
<span class="c1">##   `1` for the middle (range(-2, 2))</span>
<span class="c1">##   `-(x+3)` for the left expansion</span>

<span class="c1">## right expansion</span>
<span class="n">zero_change_error</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">X_rules</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="c1">## left expansion</span>
<span class="n">zero_change_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X_rules</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">X_rules</span><span class="o">+</span><span class="mi">3</span><span class="p">),</span> <span class="n">zero_change_error</span><span class="p">)</span>
<span class="c1">## zero ing for other values</span>
<span class="n">zero_change_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">X_rules</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">X_rules</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">zero_change_error</span><span class="p">)</span>
<span class="c1">## the middle values</span>
<span class="n">zero_change_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">X_rules</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">X_rules</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">zero_change_error</span><span class="p">)</span>


<span class="c1">## for positive granule, the left expansion equation is `1/4 (x-1)`</span>
<span class="c1">## And the right expansion equation is `1` </span>

<span class="n">positive_change_error</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="n">X_rules</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">positive_change_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X_rules</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">positive_change_error</span><span class="p">)</span>
<span class="n">positive_change_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X_rules</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">positive_change_error</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_rules</span><span class="p">,</span> <span class="n">negative_change_error</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_rules</span><span class="p">,</span> <span class="n">zero_change_error</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_rules</span><span class="p">,</span> <span class="n">positive_change_error</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$\mu(\Delta(error))$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$\Delta \; error$&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="mi">8</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="s2">&quot;$\Delta$Error</span><span class="se">\n</span><span class="s2"> Memeberhip&quot;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>


<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;negative&#39;</span><span class="p">,</span> <span class="s1">&#39;zero&#39;</span><span class="p">,</span> <span class="s1">&#39;positive&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/main_27_0.png" src="../../_images/main_27_0.png" />
</div>
</div>
<p>And the control Action rule is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_action</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">151</span><span class="p">)</span>


<span class="c1">## equations for small action is</span>
<span class="c1">##   `1/2 (x-1)` for x in range(1, 3)</span>
<span class="c1">##   `-1/2 (x-5)` for x in range(3, 5)</span>
<span class="c1">##   `0` otherwise</span>

<span class="n">small_action</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span> <span class="p">(</span><span class="n">X_action</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">small_action</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">X_action</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">X_action</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">),</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">X_action</span><span class="o">-</span><span class="mi">5</span><span class="p">),</span> <span class="n">small_action</span><span class="p">)</span>
<span class="n">small_action</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">X_action</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">X_action</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">small_action</span><span class="p">)</span>

<span class="c1">## equations for medium action is</span>
<span class="c1">##  `1/2 (x-4)` for x in range(4,6)</span>
<span class="c1">##  `-1/2 (x-10)` for x in range(8,10)</span>
<span class="c1">##  `1` for x range(6,8)</span>
<span class="c1">##  `0` otherwise</span>

<span class="n">medium_action</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">X_action</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<span class="n">medium_action</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">X_action</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">X_action</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">),</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">X_action</span><span class="o">-</span><span class="mi">10</span><span class="p">),</span> <span class="n">medium_action</span><span class="p">)</span>
<span class="n">medium_action</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">X_action</span> <span class="o">&gt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">X_action</span> <span class="o">&lt;=</span> <span class="mi">8</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">medium_action</span><span class="p">)</span>
<span class="n">medium_action</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">X_action</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">X_action</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">medium_action</span><span class="p">)</span>

<span class="c1">## And equations for big action is</span>
<span class="c1">##   `1/3 (x-7)` for x in range(7, 10)</span>
<span class="c1">##   `-1/2 (x-12)` for x in range(10, 12)</span>
<span class="c1">##   `0` otherwise</span>
<span class="n">big_action</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">X_action</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">big_action</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">X_action</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">X_action</span> <span class="o">&lt;</span> <span class="mi">12</span><span class="p">),</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">X_action</span><span class="o">-</span><span class="mi">12</span><span class="p">),</span> <span class="n">big_action</span><span class="p">)</span>
<span class="n">big_action</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">X_action</span> <span class="o">&lt;=</span> <span class="mi">7</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">X_action</span> <span class="o">&gt;=</span> <span class="mi">12</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">big_action</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_action</span><span class="p">,</span> <span class="n">small_action</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_action</span><span class="p">,</span> <span class="n">medium_action</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_action</span><span class="p">,</span> <span class="n">big_action</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$\mu(control action)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;control action&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="s2">&quot;Control Action</span><span class="se">\n</span><span class="s2"> membership&quot;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>


<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;big&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/main_29_0.png" src="../../_images/main_29_0.png" />
</div>
</div>
<p>Until now we have plotted the membership values, so now we will dive into the answers.</p>
<p>Find the fuzzy set of control while Having <code class="docutils literal notranslate"><span class="pre">error</span> <span class="pre">=</span> <span class="pre">2</span></code> and <code class="docutils literal notranslate"><span class="pre">change</span> <span class="pre">of</span> <span class="pre">error=4</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Creating the usable format of the actions, error and change of error </span>
<span class="n">SMALL_ACTION</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">X_action</span><span class="p">,</span> <span class="n">small_action</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">MEDIUM_ACTION</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">X_action</span><span class="p">,</span> <span class="n">medium_action</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">BIG_ACTION</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">X_action</span><span class="p">,</span> <span class="n">big_action</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">NEGATIVE_Error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">X_rules</span><span class="p">,</span> <span class="n">negative_error</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ZERO_Error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">X_rules</span><span class="p">,</span> <span class="n">zero_error</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">POSITIVE_Error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">X_rules</span><span class="p">,</span> <span class="n">positive_error</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">NEGATIVE_CHANGE_Error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">X_rules</span><span class="p">,</span> <span class="n">negative_change_error</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ZERO_CHANGE_Error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">X_rules</span><span class="p">,</span> <span class="n">zero_change_error</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">POSITIVE_CHANGE_Error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">X_rules</span><span class="p">,</span> <span class="n">positive_change_error</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Find the values </span>
<span class="k">def</span> <span class="nf">find_membership_value</span><span class="p">(</span><span class="n">fuzzy_set</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find the fuzzy membership value of a fuzzy set using the input `x`</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    fuzzy_set : array of 2D tuple</span>
<span class="sd">        the fuzzy set we need to use</span>
<span class="sd">    x : float or integer</span>
<span class="sd">        using the x value find the fuzzy membership value </span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    ---------</span>
<span class="sd">    value : floating between 0 and 1</span>
<span class="sd">        the normalized membership value of the fuzzy set</span>
<span class="sd">        Note: the fuzzy_set in the input must be normalized</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">fuzzy_set</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">][</span><span class="n">fuzzy_set</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">value</span>

<span class="n">error</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">error_change</span> <span class="o">=</span> <span class="mi">4</span>

<span class="n">negative_error_membership_value</span> <span class="o">=</span> <span class="n">find_membership_value</span><span class="p">(</span><span class="n">NEGATIVE_Error</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
<span class="n">zero_error_membership_value</span> <span class="o">=</span> <span class="n">find_membership_value</span><span class="p">(</span><span class="n">ZERO_Error</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
<span class="n">positive_error_membership_value</span> <span class="o">=</span> <span class="n">find_membership_value</span><span class="p">(</span><span class="n">POSITIVE_Error</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>

<span class="n">negative_change_error_membership_value</span> <span class="o">=</span> <span class="n">find_membership_value</span><span class="p">(</span><span class="n">NEGATIVE_CHANGE_Error</span><span class="p">,</span> <span class="n">error_change</span><span class="p">)</span>
<span class="n">zero_change_error_membership_value</span> <span class="o">=</span> <span class="n">find_membership_value</span><span class="p">(</span><span class="n">ZERO_CHANGE_Error</span><span class="p">,</span> <span class="n">error_change</span><span class="p">)</span>
<span class="n">positive_change_error_membership_value</span> <span class="o">=</span> <span class="n">find_membership_value</span><span class="p">(</span><span class="n">POSITIVE_CHANGE_Error</span><span class="p">,</span> <span class="n">error_change</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Checking Rules
Using Mamdani implication</strong></p>
<ul class="simple">
<li><p>if error is negative and <span class="math notranslate nohighlight">\(\Delta\)</span> Error is negative <span class="math notranslate nohighlight">\(\rightarrow\)</span> Then action is big</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Find the values of actions using the rule table</span>

<span class="c1">## If delta error is negative and error is negative then the action is big</span>
<span class="c1">## Let&#39;s see the big action fuzzy value</span>
<span class="n">values_tuple</span> <span class="o">=</span><span class="p">(</span><span class="n">negative_change_error_membership_value</span><span class="p">,</span> <span class="n">negative_error_membership_value</span><span class="p">)</span>

<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">values_tuple</span><span class="p">)</span>
<span class="n">big_action_membership_value</span> <span class="o">=</span> <span class="n">values_tuple</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">big_action_membership_value</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.])
</pre></div>
</div>
</div>
</div>
<p>So the fuzzy value is zero, so there is no need to have in mind the rule above</p>
<ul class="simple">
<li><p>if error is zero and <span class="math notranslate nohighlight">\(\Delta\)</span> Error is negative <span class="math notranslate nohighlight">\(\rightarrow\)</span> Then action is big</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">values_tuple</span> <span class="o">=</span><span class="p">(</span><span class="n">zero_error_membership_value</span><span class="p">,</span> <span class="n">zero_change_error_membership_value</span><span class="p">)</span>

<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">values_tuple</span><span class="p">)</span>
<span class="n">big_action_membership_value</span> <span class="o">=</span> <span class="n">values_tuple</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">big_action_membership_value</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.])
</pre></div>
</div>
</div>
</div>
<p>Again in this rule the action for big have zero fuzzy value, Let’s see others.</p>
<ul class="simple">
<li><p>if error is zero and <span class="math notranslate nohighlight">\(\Delta\)</span> Error is zero <span class="math notranslate nohighlight">\(\rightarrow\)</span> Then action is medium</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">values_tuple</span> <span class="o">=</span><span class="p">(</span><span class="n">zero_error_membership_value</span><span class="p">,</span> <span class="n">zero_change_error_membership_value</span><span class="p">)</span>

<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">values_tuple</span><span class="p">)</span>
<span class="n">medium_action_membership_value</span> <span class="o">=</span> <span class="n">values_tuple</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">medium_action_membership_value</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.])
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>if error is zero and <span class="math notranslate nohighlight">\(\Delta\)</span> Error is positive <span class="math notranslate nohighlight">\(\rightarrow\)</span> Then action is medium</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">values_tuple</span> <span class="o">=</span><span class="p">(</span><span class="n">zero_error_membership_value</span><span class="p">,</span> <span class="n">positive_change_error_membership_value</span><span class="p">)</span>

<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">values_tuple</span><span class="p">)</span>
<span class="n">medium_action_membership_value</span> <span class="o">=</span> <span class="n">values_tuple</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">medium_action_membership_value</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.33333333])
</pre></div>
</div>
</div>
</div>
<p>✅ So the medium action fuzzy value can be extracted using the last rule.</p>
<ul class="simple">
<li><p>if error is positive and <span class="math notranslate nohighlight">\(\Delta\)</span> Error is zero <span class="math notranslate nohighlight">\(\rightarrow\)</span> Then action is small</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">values_tuple</span> <span class="o">=</span><span class="p">(</span><span class="n">positive_error_membership_value</span><span class="p">,</span> <span class="n">zero_change_error_membership_value</span><span class="p">)</span>

<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">values_tuple</span><span class="p">)</span>
<span class="n">small_action_membership_value</span> <span class="o">=</span> <span class="n">values_tuple</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">small_action_membership_value</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.])
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>if error is positive and <span class="math notranslate nohighlight">\(\Delta\)</span> Error is positive <span class="math notranslate nohighlight">\(\rightarrow\)</span> Then action is small</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">values_tuple</span> <span class="o">=</span><span class="p">(</span><span class="n">positive_error_membership_value</span><span class="p">,</span> <span class="n">positive_change_error_membership_value</span><span class="p">)</span>

<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">values_tuple</span><span class="p">)</span>
<span class="n">small_action_membership_value</span> <span class="o">=</span> <span class="n">values_tuple</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">small_action_membership_value</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.5])
</pre></div>
</div>
</div>
</div>
<p>✅ And we found  <code class="docutils literal notranslate"><span class="pre">0.5</span></code> membership value for small action using the last rule.</p>
<p>So until now what we have is</p>
<ul class="simple">
<li><p>if <em>error is zero</em> and <em><span class="math notranslate nohighlight">\(\Delta\)</span> Error is positive</em> Then <em>Medium action</em> with confidence = 0.333</p></li>
<li><p>If <em>error is positive</em> and <em>change of error is positive</em> Then <em>Small action</em> with confidence = 0.5</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_MEDIUM</span> <span class="o">=</span> <span class="n">MEDIUM_ACTION</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">][</span><span class="n">MEDIUM_ACTION</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.333</span><span class="p">]</span>
<span class="n">Y_MEDIUM</span> <span class="o">=</span> <span class="n">MEDIUM_ACTION</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">][</span><span class="n">MEDIUM_ACTION</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.333</span><span class="p">]</span>
<span class="n">X_Small</span> <span class="o">=</span> <span class="n">SMALL_ACTION</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">][</span><span class="n">SMALL_ACTION</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="n">Y_Small</span> <span class="o">=</span> <span class="n">SMALL_ACTION</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">][</span><span class="n">SMALL_ACTION</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">X_MEDIUM</span><span class="p">,</span> <span class="n">Y_MEDIUM</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">X_Small</span><span class="p">,</span> <span class="n">Y_Small</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Action Medium&#39;</span><span class="p">,</span> <span class="s1">&#39;Action Small&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="s1">&#39;fuzzy inference&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/main_48_0.png" src="../../_images/main_48_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## The maximums are in small action</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">SMALL_ACTION</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">SMALL_ACTION</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Y_Small</span><span class="p">))]</span>

<span class="c1">## Mean of Maxima</span>
<span class="n">Z_star_MOM</span> <span class="o">=</span> <span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">U</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">Z_star_MOM</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.0
</pre></div>
</div>
</div>
</div>
<p>To find Center Of gravity, we would like to use the equation below
\begin{equation}
Z^{*}_{COG} = \frac{\sum \mu_x x}{\sum \mu_x}
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## To find Center of Gravity</span>
<span class="c1">## initialize</span>

<span class="c1">## divide equation in two parts </span>
<span class="c1">## above division and below</span>
<span class="n">above</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">X_Small</span> <span class="o">*</span> <span class="n">Y_Small</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">X_MEDIUM</span> <span class="o">*</span> <span class="n">Y_MEDIUM</span><span class="p">)</span>
<span class="n">below</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Y_Small</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Y_MEDIUM</span><span class="p">)</span>

<span class="n">Z_star_COG</span> <span class="o">=</span> <span class="n">above</span> <span class="o">/</span> <span class="n">below</span>
<span class="n">Z_star_COG</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.105263157894735
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Plotting the Mamdani inference Result</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">X_MEDIUM</span><span class="p">,</span> <span class="n">Y_MEDIUM</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">X_Small</span><span class="p">,</span> <span class="n">Y_Small</span><span class="p">)</span>

<span class="c1">## plotting the Mean of Maxima</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Z_star_MOM</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Y_Small</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">Z_star_MOM</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Y_Small</span><span class="p">),</span> <span class="mi">10</span><span class="p">),</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Z_star_MOM</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.180</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="s1">&#39;MOM: $Z^*$&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>

<span class="c1">## plotting the COG</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">Z_star_COG</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="s1">&#39;g--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Z_star_COG</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="s1">&#39;COG: $Z^*$&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>


<span class="c1">## Other options in plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Action Medium&#39;</span><span class="p">,</span> <span class="s1">&#39;Action Small&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="s1">&#39;fuzzy Mamdani </span><span class="se">\n</span><span class="s1">inference&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/main_52_0.png" src="../../_images/main_52_0.png" />
</div>
</div>
</section>
<section id="q6">
<h3>Q6<a class="headerlink" href="#q6" title="Permalink to this headline">#</a></h3>
<p>Answer to the question 9 of chapter 4 using Ross Book.</p>
<p>To answer this question we first draw the fuzzified outputs and then go deep into the answer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## plotting (a) Figure P4.9</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>

<span class="c1">## equations for plotting (a) is as below</span>
<span class="c1">##  `1/4 (x)` for x in [0, 2]</span>
<span class="c1">##  `0.5` for x in [2, 3]</span>
<span class="c1">##  `-1/2 (x-4)` for x in [3, 4]</span>
<span class="c1">##  `0` otherwise</span>
<span class="n">mu_A</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">x</span>
<span class="n">mu_A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">),</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">mu_A</span><span class="p">)</span>
<span class="n">mu_A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">x</span> <span class="o">&gt;</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">),</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">4</span><span class="p">),</span> <span class="n">mu_A</span><span class="p">)</span>
<span class="n">mu_A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mu_A</span><span class="p">)</span>

<span class="c1">## equations for plotting (b) is</span>
<span class="c1">##   `0.35 (x-2)` for x in [2, 4]</span>
<span class="c1">##   `-0.7 (x-5)` for x in [4, 5]</span>
<span class="c1">##   `0` otherwise</span>
<span class="n">mu_B</span> <span class="o">=</span> <span class="mf">0.35</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="n">mu_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span><span class="mi">5</span><span class="p">),</span> <span class="o">-</span><span class="mf">0.7</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">5</span><span class="p">),</span> <span class="n">mu_B</span><span class="p">)</span>
<span class="n">mu_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mu_B</span><span class="p">)</span>

<span class="c1">## equations for plotting (c) is</span>
<span class="c1">##   `(x-4)` for x in [4, 5]</span>
<span class="c1">##   `1` for x in [5, 7]</span>
<span class="c1">##   `-1/2 (x-9)` for x in [7, 9]</span>
<span class="c1">##   `0` otherwise</span>
<span class="n">mu_C</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="mi">4</span>
<span class="n">mu_C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">7</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mu_C</span><span class="p">)</span>
<span class="n">mu_C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">),</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">9</span><span class="p">)</span> <span class="p">,</span> <span class="n">mu_C</span><span class="p">)</span>
<span class="n">mu_C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">9</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">0</span> <span class="p">,</span> <span class="n">mu_C</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu_A</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\mu$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="s1">&#39;$\mu_</span><span class="si">{a}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu_B</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\mu$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="s1">&#39;$\mu_</span><span class="si">{b}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu_C</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\mu$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="s1">&#39;$\mu_</span><span class="si">{c}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/main_56_0.png" src="../../_images/main_56_0.png" />
</div>
</div>
<p>Now we saw the memebership functions results. Let’s plot them together and then have a defuzzification process using <code class="docutils literal notranslate"><span class="pre">Weighted</span> <span class="pre">Average</span></code>, <code class="docutils literal notranslate"><span class="pre">Centeroid</span> <span class="pre">(COG)</span></code>, <code class="docutils literal notranslate"><span class="pre">Mean</span> <span class="pre">of</span> <span class="pre">Maxima</span> <span class="pre">(MOM)</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span> <span class="pre">membership</span></code>, <code class="docutils literal notranslate"><span class="pre">Left</span> <span class="pre">of</span> <span class="pre">Maxima</span> <span class="pre">(LOM)</span></code> and <code class="docutils literal notranslate"><span class="pre">Right</span> <span class="pre">of</span> <span class="pre">Maxima</span> <span class="pre">(ROM)</span></code> methods.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## The union of the results is as below</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu_A</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu_B</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu_C</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;$\mu_A$&#39;</span><span class="p">,</span> <span class="s1">&#39;$\mu_B$&#39;</span><span class="p">,</span> <span class="s1">&#39;$\mu_C$&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/main_58_0.png" src="../../_images/main_58_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu_union</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">mu_A</span><span class="p">,</span> <span class="n">mu_B</span><span class="p">),</span> <span class="n">mu_C</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu_union</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;$\mu_A \cup \mu_B \cup \mu_C$&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/main_59_0.png" src="../../_images/main_59_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fuzzy_union_set</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">mu_union</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## the maximum defuzzification method</span>
<span class="n">z_star_max</span> <span class="o">=</span> <span class="n">fuzzy_union_set</span><span class="p">[</span>
    <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">fuzzy_union_set</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">fuzzy_union_set</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]))</span>
               <span class="p">]</span>
<span class="n">z_star_max</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(21, 2)
</pre></div>
</div>
</div>
</div>
<p>In this case we’re having more than one value in defuzzification process, So we can say that there would be no appropriate result in defuzzification of flat fuzzy numbers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## mean of maxima defuzzification process</span>
<span class="n">avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">z_star_max</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">z_star_mom</span> <span class="o">=</span> <span class="n">z_star_max</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">z_star_max</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">avg</span><span class="p">)]</span>

<span class="n">z_star_mom</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[6., 1.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## weighted average defuzzification process</span>

<span class="c1">## first we create the fuzzy sets of membership values</span>
<span class="n">fuzzy_mu_A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">mu_A</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fuzzy_mu_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">mu_B</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fuzzy_mu_C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">mu_C</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">average_A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">fuzzy_mu_A</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">][</span><span class="n">fuzzy_mu_A</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">average_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">fuzzy_mu_B</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">][</span><span class="n">fuzzy_mu_B</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">average_C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">fuzzy_mu_C</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">][</span><span class="n">fuzzy_mu_C</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Averages A,B,C: </span><span class="si">{</span><span class="n">average_A</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">average_B</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">average_C</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1">## to average</span>
<span class="n">average_mu_A</span> <span class="o">=</span> <span class="n">fuzzy_mu_A</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">fuzzy_mu_A</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">average_A</span><span class="p">)]</span>
<span class="n">average_mu_B</span> <span class="o">=</span> <span class="n">fuzzy_mu_A</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">fuzzy_mu_A</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">average_B</span><span class="p">)]</span>
<span class="n">average_mu_C</span> <span class="o">=</span> <span class="n">fuzzy_mu_A</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">fuzzy_mu_A</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">average_C</span><span class="p">)]</span>

<span class="c1">## devide the weigted average equation in two parts</span>
<span class="c1">## above division and below of the division</span>
<span class="n">above</span> <span class="o">=</span> <span class="p">(</span><span class="n">average_mu_A</span> <span class="o">*</span> <span class="n">average_A</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">average_mu_B</span> <span class="o">*</span> <span class="n">average_B</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">average_mu_C</span> <span class="o">*</span> <span class="n">average_C</span><span class="p">)</span>
<span class="n">below</span> <span class="o">=</span> <span class="n">average_mu_A</span> <span class="o">+</span> <span class="n">average_mu_B</span> <span class="o">+</span> <span class="n">average_mu_C</span>

<span class="n">z_star_weigted_avg</span> <span class="o">=</span> <span class="n">above</span> <span class="o">/</span> <span class="n">below</span>
<span class="n">z_star_weigted_avg</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Averages A,B,C: 2.0, 3.5, 6.5
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2.5])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Center of gravity defuzzification process</span>

<span class="n">z_star_COG</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu_union</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mu_union</span><span class="p">)</span>
<span class="n">z_star_COG</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.097685185185185
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## it&#39;s easy to find left of maxima and right of maxima</span>

<span class="n">z_star_LOM</span> <span class="o">=</span> <span class="n">z_star_max</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">z_star_ROM</span> <span class="o">=</span> <span class="n">z_star_max</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">z_star_LOM</span><span class="p">,</span> <span class="n">z_star_ROM</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(5.0, 7.0)
</pre></div>
</div>
</div>
</div>
<p>We’ve now found result values using 6 defuzzification process. Let’s plot them:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## first we created the union fuzzy set</span>
<span class="n">union_fuzzy_set</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">mu_union</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find_fuzzy_value</span><span class="p">(</span><span class="n">fuzzy_set</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find fuzzy membership value of x</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    fuzzy_set : array of 2D tupple</span>
<span class="sd">        The fuzzy set we have</span>
<span class="sd">    x : float</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    ---------</span>
<span class="sd">    fuzzy_value : float</span>
<span class="sd">        a floating point represent the fuzzy membership value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fuzzy_value</span> <span class="o">=</span> <span class="n">fuzzy_set</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">fuzzy_set</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">))]</span>
    
    <span class="k">return</span> <span class="n">fuzzy_value</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">z_star_COG_fuzzy_value</span> <span class="o">=</span> <span class="n">find_fuzzy_value</span><span class="p">(</span><span class="n">union_fuzzy_set</span><span class="p">,</span> <span class="n">z_star_COG</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">z_star_COG</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">z_star_COG_fuzzy_value</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">)</span>

<span class="n">z_star_LOM_fuzzy_value</span> <span class="o">=</span> <span class="n">find_fuzzy_value</span><span class="p">(</span><span class="n">union_fuzzy_set</span><span class="p">,</span> <span class="n">z_star_LOM</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">z_star_LOM</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">z_star_LOM_fuzzy_value</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="p">,</span> <span class="s1">&#39;g--&#39;</span><span class="p">)</span>

<span class="n">z_star_ROM_fuzzy_value</span> <span class="o">=</span> <span class="n">find_fuzzy_value</span><span class="p">(</span><span class="n">union_fuzzy_set</span><span class="p">,</span> <span class="n">z_star_ROM</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">z_star_ROM</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">z_star_ROM_fuzzy_value</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">)</span>

<span class="n">z_star_MOM_fuzzy_value</span> <span class="o">=</span> <span class="n">find_fuzzy_value</span><span class="p">(</span><span class="n">union_fuzzy_set</span><span class="p">,</span> <span class="n">z_star_mom</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">z_star_mom</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">z_star_MOM_fuzzy_value</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>

<span class="c1"># z_star_Weighted_avg_fuzzy_value = find_fuzzy_value(union_fuzzy_set, z_star_weigted_avg)</span>
<span class="c1"># plt.plot(np.ones(10) * z_star_weigted_avg, np.linspace(0, z_star_Weighted_avg_fuzzy_value, 10) , &#39;o--&#39;)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu_union</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span>
    <span class="s1">&#39;$Z^{*}_</span><span class="si">{COG}</span><span class="s1">$&#39;</span><span class="p">,</span>
    <span class="s1">&#39;$Z^{*}_</span><span class="si">{LOM}</span><span class="s1">$&#39;</span><span class="p">,</span>
    <span class="s1">&#39;$Z^{*}_</span><span class="si">{ROM}</span><span class="s1">$&#39;</span><span class="p">,</span>
    <span class="s1">&#39;$Z^{*}_</span><span class="si">{MOM}</span><span class="s1">$&#39;</span><span class="p">,</span>
<span class="c1">#     &#39;$Z^{*}_{Weighted \; avg}$&#39;,</span>
    <span class="s1">&#39;$\mu_A \cup \mu_B \cup \mu_C$&#39;</span>
<span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="mf">0.4</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;The union of the fuzzy values is the filled shapes</span>
<span class="s1">                And the results of each defuzzification processes is the dotted lines&#39;&#39;&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/main_69_0.png" src="../../_images/main_69_0.png" />
</div>
</div>
</section>
</section>
<section id="data-driven-modeling">
<h2>Data-Driven Modeling<a class="headerlink" href="#data-driven-modeling" title="Permalink to this headline">#</a></h2>
<section id="q7">
<h3>Q7<a class="headerlink" href="#q7" title="Permalink to this headline">#</a></h3>
<p>Answer to question 5 of chapter 7 in Ross book</p>
<p>We need to apply Clustering Method on the dataset, So we need to first implement it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## initilize the dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span>
    <span class="p">[</span><span class="mi">6800</span><span class="p">,</span> <span class="mi">6834</span><span class="p">,</span> <span class="mf">1.23e-2</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">6500</span><span class="p">,</span> <span class="mi">6492</span><span class="p">,</span> <span class="mf">1.02e-2</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">6900</span><span class="p">,</span> <span class="mi">6950</span><span class="p">,</span> <span class="mf">1.34e-2</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">6875</span><span class="p">,</span> <span class="mi">6700</span><span class="p">,</span> <span class="mf">1.31e-2</span><span class="p">]</span>
    <span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;delta_l&#39;</span><span class="p">],)</span>
<span class="n">dataset</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x1</th>
      <th>x2</th>
      <th>delta_l</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6800</td>
      <td>6834</td>
      <td>0.0123</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6500</td>
      <td>6492</td>
      <td>0.0102</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6900</td>
      <td>6950</td>
      <td>0.0134</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6875</td>
      <td>6700</td>
      <td>0.0131</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span>
    <span class="p">[</span><span class="mi">7000</span><span class="p">,</span> <span class="mi">6500</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">175</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">6850</span><span class="p">,</span> <span class="mi">3200</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">175</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">6500</span><span class="p">,</span> <span class="mi">4500</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">175</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">6000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">175</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">6200</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mf">83.5</span><span class="p">,</span> <span class="mi">175</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">6315</span><span class="p">,</span> <span class="mi">5800</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">175</span><span class="p">]</span>
    <span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c1&#39;</span><span class="p">,</span> <span class="s1">&#39;c2&#39;</span><span class="p">,</span> <span class="s1">&#39;sigma_3&#39;</span><span class="p">,</span> <span class="s1">&#39;sigma_4&#39;</span><span class="p">])</span>
<span class="n">parameters</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>c1</th>
      <th>c2</th>
      <th>sigma_3</th>
      <th>sigma_4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7000</td>
      <td>6500</td>
      <td>175.0</td>
      <td>175</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6850</td>
      <td>3200</td>
      <td>135.0</td>
      <td>175</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6500</td>
      <td>4500</td>
      <td>121.0</td>
      <td>175</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6000</td>
      <td>5000</td>
      <td>85.0</td>
      <td>175</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6200</td>
      <td>5000</td>
      <td>83.5</td>
      <td>175</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6315</td>
      <td>5800</td>
      <td>87.0</td>
      <td>175</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We use gaussian function as our membership function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gaussian</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">Mu</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The gaussian distribution</span>
<span class="sd">    </span>
<span class="sd">    Paremeters:</span>
<span class="sd">    ------------</span>
<span class="sd">    X : array_like</span>
<span class="sd">        the input range, can be an array of floating points</span>
<span class="sd">    Sigma : float</span>
<span class="sd">        the variance for gaussian distribution</span>
<span class="sd">    Mu : float</span>
<span class="sd">        the mean for gaussian distribution</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    ---------</span>
<span class="sd">    Y : array_like</span>
<span class="sd">        same dimension as input `X`</span>
<span class="sd">        the values representing gaussian distribution</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">Sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">Mu</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">Sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>

    <span class="n">Y</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">*</span> <span class="n">p2</span>
    <span class="k">return</span> <span class="n">Y</span>
<span class="k">def</span> <span class="nf">CM_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The function that is used for Clustering method </span>
<span class="sd">    with parameters `theta=(A, B, V, sigma)`</span>
<span class="sd">    the gaussian function will be used for each rule in this function</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    x : array_like</span>
<span class="sd">        the input data</span>
<span class="sd">    A : 1D array</span>
<span class="sd">        the parameters for each membership function</span>
<span class="sd">    B : 1D array</span>
<span class="sd">        this parameter shows how many data is used for a rule</span>
<span class="sd">    V : array_like</span>
<span class="sd">        the mean values of data, `V.shape[1]` must match the data features count</span>
<span class="sd">    sigma : 1D array</span>
<span class="sd">        contains values for each rule standar deviation</span>
<span class="sd">        length must match the data features count</span>
<span class="sd">        </span>
<span class="sd">    Note: the length of `A`, `B` and `V` arrays must be the same</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    ---------</span>
<span class="sd">    predicted : float</span>
<span class="sd">        the predicted value for an input x using the parameter theta</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">## the results for above and below the division</span>
    <span class="n">result_above</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">result_below</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)):</span>
        <span class="c1">## initilize the variable with one because we are going to multiply it</span>
        <span class="n">gaussian_function_result</span> <span class="o">=</span> <span class="mi">1</span> 
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
            <span class="n">gaussian_function_result</span> <span class="o">=</span> <span class="n">gaussian_function_result</span> <span class="o">*</span> <span class="n">gaussian</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sigma</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
        <span class="n">result_above</span> <span class="o">+=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">gaussian_function_result</span>
        <span class="n">result_below</span> <span class="o">+=</span> <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">gaussian_function_result</span>
        
    <span class="n">results</span> <span class="o">=</span> <span class="n">result_above</span> <span class="o">/</span> <span class="n">result_below</span>
    <span class="k">return</span> <span class="n">results</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Y_data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[[</span><span class="s1">&#39;delta_l&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>

<span class="n">sigma1</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[[</span><span class="s1">&#39;sigma_3&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">sigma2</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[[</span><span class="s1">&#39;sigma_4&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>

<span class="n">Sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sigma1</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[[</span><span class="s1">&#39;c1&#39;</span><span class="p">,</span> <span class="s1">&#39;c2&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>

<span class="n">f_Y</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_data</span><span class="p">)):</span>
    <span class="n">y_predicted</span> <span class="o">=</span> <span class="n">CM_function</span><span class="p">(</span><span class="n">X_data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">A</span><span class="o">=</span> <span class="n">Y_data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">B</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">Sigma</span><span class="p">)</span>
    <span class="n">f_Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_predicted</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_Y</span> <span class="o">-</span> <span class="n">Y_data</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0., 0., 0.]])
</pre></div>
</div>
</div>
</div>
<p>We saw that using the rules given in the question we’ve found the outputs of the fuzzy system same as the output value <span class="math notranslate nohighlight">\(\delta_L\)</span> and our model is working perfectly. Now Let’s plot the rules</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">80000</span><span class="p">)</span> 

<span class="n">rules_count</span> <span class="o">=</span> <span class="mi">6</span>

<span class="c1">## initilize a value for y rules plot</span>
<span class="n">Y_rule_X1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">Y_rule_X2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rules_count</span><span class="p">):</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Sigma</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">Y_rule_X1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    
    <span class="n">Y</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Sigma</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">Y_rule_X2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1">## plot mu_X1</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rules_count</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y_rule_X1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Rule 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Rule 2&#39;</span><span class="p">,</span><span class="s1">&#39;Rule 3&#39;</span><span class="p">,</span><span class="s1">&#39;Rule 4&#39;</span><span class="p">,</span><span class="s1">&#39;Rule 5&#39;</span><span class="p">,</span><span class="s1">&#39;Rule 6&#39;</span><span class="p">,])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">8000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">5100</span><span class="p">,</span> <span class="mf">0.003</span><span class="p">,</span> <span class="s1">&#39;$\mu_</span><span class="si">{x_1}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/main_82_0.png" src="../../_images/main_82_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1">## plot mu_X1</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rules_count</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y_rule_X2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Rule 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Rule 2&#39;</span><span class="p">,</span><span class="s1">&#39;Rule 3&#39;</span><span class="p">,</span><span class="s1">&#39;Rule 4&#39;</span><span class="p">,</span><span class="s1">&#39;Rule 5&#39;</span><span class="p">,</span><span class="s1">&#39;Rule 6&#39;</span><span class="p">,])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">,</span> <span class="s1">&#39;$\mu_</span><span class="si">{x_2}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/main_83_0.png" src="../../_images/main_83_0.png" />
</div>
</div>
</section>
<section id="q8">
<h3>Q8<a class="headerlink" href="#q8" title="Permalink to this headline">#</a></h3>
<p>Answer the question 9, Chapter 6 of Ross book.</p>
<p>First we prepare the dataset used in this question.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> 
                        <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.74</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.37</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
<span class="n">dataset</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.3</td>
      <td>0.74</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.6</td>
      <td>0.55</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.0</td>
      <td>0.37</td>
    </tr>
    <tr>
      <th>4</th>
      <td>100.0</td>
      <td>0.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>And the rules defined in the question are as below</p>
<ul class="simple">
<li><p>If X is Large then Y is Zero</p></li>
<li><p>If X is Small then Y is Small</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## find the C values for the equation in the cell below</span>
<span class="c1">## we can apply C values manually but we represent this way as an alternative</span>
<span class="n">C_min_x</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[[</span><span class="s1">&#39;x&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">C_min_y</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[[</span><span class="s1">&#39;y&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">C_max_x</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[[</span><span class="s1">&#39;x&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">C_max_y</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[[</span><span class="s1">&#39;y&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>\begin{equation}
C_i = C_{min} + \frac{b}{2^L - 1} (C_{max_i} - C_{min_i})
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## the implementation of equation above</span>
<span class="k">def</span> <span class="nf">find_C_value</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">c_min</span><span class="p">,</span> <span class="n">c_max</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find the value of `C` parameter for the genetic algorithm</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    b : float</span>
<span class="sd">        decimal value representive of the input value of the data</span>
<span class="sd">    L : positive integer</span>
<span class="sd">        value representing the length of each string in genetic algorithm</span>
<span class="sd">    c_min : float or integer</span>
<span class="sd">        decimal value representive for the smallest value that is fitted in dataset</span>
<span class="sd">    c_max : float or integer</span>
<span class="sd">        decimal value representive for the biggest value that is fitted in dataset</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    ---------</span>
<span class="sd">    C : float</span>
<span class="sd">        the parameter representive for the value of b</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">C</span> <span class="o">=</span> <span class="n">c_min</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">L</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">c_max</span> <span class="o">-</span> <span class="n">c_min</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">C</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_binary_representation_array</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">binary_width</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    get the binary rerpresentation of an array</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    x : array_like</span>
<span class="sd">        input decimal values</span>
<span class="sd">    binary_width : positive integer</span>
<span class="sd">        the value representive the count of the zeros and ones</span>
<span class="sd">        Important to set this with respect to `x` values</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    ---------</span>
<span class="sd">    x_bin : string array</span>
<span class="sd">        binary string representation of decimal inputs </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1">## find the binary representation of the population</span>
    <span class="n">x_bin</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
        <span class="c1">## binary population</span>
        <span class="n">binary_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">binary_repr</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> 
                                    <span class="n">width</span><span class="o">=</span><span class="n">binary_width</span><span class="p">)</span>

        <span class="n">x_bin</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">binary_x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">x_bin</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## initialize the population using random binary value</span>

<span class="n">maximum_random_value</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">minimum_random_value</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1">## we need to specify four bases for our rules</span>
<span class="n">bases_count</span> <span class="o">=</span> <span class="mi">4</span> 

<span class="c1">## the width of the population strings</span>
<span class="n">population_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">maximum_random_value</span><span class="p">)))</span>

<span class="c1">## fix the random seed </span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>

<span class="n">population</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span>
    <span class="n">minimum_random_value</span><span class="p">,</span>
    <span class="n">maximum_random_value</span><span class="p">,</span>
    <span class="n">bases_count</span><span class="p">)</span>
<span class="c1">## transfer to binary representation</span>
<span class="n">population_binary_representation</span> <span class="o">=</span> <span class="n">get_binary_representation_array</span><span class="p">(</span>
    <span class="n">population</span><span class="p">,</span>
    <span class="n">population_width</span>
<span class="p">)</span>

<span class="c1">## convert to numpy for ease of use in later</span>
<span class="n">population_binary_representation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="n">population_binary_representation</span>
<span class="p">)</span>

<span class="n">population</span><span class="p">,</span> <span class="n">population_binary_representation</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([62, 45, 62,  2]),
 array([&#39;111110&#39;, &#39;101101&#39;, &#39;111110&#39;, &#39;000010&#39;], dtype=&#39;&lt;U6&#39;))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bases_x</span> <span class="o">=</span> <span class="n">find_C_value</span><span class="p">(</span><span class="n">population</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">population_width</span><span class="p">,</span> <span class="n">C_min_x</span><span class="p">,</span> <span class="n">C_max_x</span> <span class="p">)</span>
<span class="n">bases_y</span> <span class="o">=</span> <span class="n">find_C_value</span><span class="p">(</span><span class="n">population</span><span class="p">[</span><span class="mi">2</span><span class="p">:],</span> <span class="n">population_width</span><span class="p">,</span> <span class="n">C_min_y</span><span class="p">,</span> <span class="n">C_max_y</span> <span class="p">)</span>

<span class="n">bases_x</span><span class="p">,</span> <span class="n">bases_y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([98.41269841, 71.42857143]), array([0.98412698, 0.03174603]))
</pre></div>
</div>
</div>
</div>
<p>Now we found some base values for our rules.</p>
<p>Let’s apply to rules and see how it works</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">right_triangle_rules</span><span class="p">(</span><span class="n">start_value</span><span class="p">,</span> <span class="n">base_width</span><span class="p">,</span> <span class="n">slope</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create right triangle membership functions for one rule</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    start_value : float</span>
<span class="sd">        the value that we are going to start the plot</span>
<span class="sd">    base_width : float</span>
<span class="sd">        the width of triangle&#39;s base</span>
<span class="sd">    slope : -1 or +1</span>
<span class="sd">        the slope of the triangle&#39;s hypotenuse</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    ----------</span>
<span class="sd">    x : 1D array_like</span>
<span class="sd">        the x values representive the x coordinates of the membership function</span>
<span class="sd">    y : 1D array_like</span>
<span class="sd">        the y values representive the membership values</span>
<span class="sd">        Note: the membership function values are normalized.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Error value for slope, can be either +1 or -1!&#39;</span>
    
    <span class="c1">## the x values start at `start_value` and ends at `start_value + base_width`</span>
    <span class="n">end_value</span> <span class="o">=</span> <span class="n">start_value</span> <span class="o">+</span> <span class="n">base_width</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start_value</span><span class="p">,</span> <span class="n">end_value</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">base_width</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
    
    <span class="c1">## finding y values via the slope</span>
    <span class="k">if</span> <span class="n">slope</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">base_width</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">end_value</span><span class="p">)</span>       
    <span class="k">else</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">base_width</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">start_value</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Rules for X</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="c1">## rule1_X_x means the X data and x axis in Rule 1</span>
<span class="c1">## rule1_X_y means the X data and y axis in Rule 1</span>
<span class="n">rule1_X_x</span><span class="p">,</span> <span class="n">rule1_X_y</span> <span class="o">=</span> <span class="n">right_triangle_rules</span><span class="p">(</span><span class="n">C_min_x</span><span class="p">,</span> <span class="n">bases_x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">## rule2_X_x means the X data and x axis in Rule 2</span>
<span class="c1">## rule2_X_y means the X data and y axis in Rule 2</span>
<span class="n">rule2_X_x</span><span class="p">,</span> <span class="n">rule2_X_y</span> <span class="o">=</span> <span class="n">right_triangle_rules</span><span class="p">(</span><span class="n">C_max_x</span> <span class="o">-</span> <span class="n">bases_x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bases_x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>    

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rule1_X_x</span><span class="p">,</span> <span class="n">rule1_X_y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rule2_X_x</span><span class="p">,</span> <span class="n">rule2_X_y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">rule1_X_x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">rule2_X_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rule1_X_x</span><span class="p">[::</span><span class="mi">800</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Rule 1. $X$ is Large &#39;</span><span class="p">,</span> <span class="s1">&#39;Rule 2. $X$ is Small&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$\mu_X$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$X$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/main_96_0.png" src="../../_images/main_96_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Rules for Y</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1">## rule1_Y_x means x axis for Y data in Rule 1</span>
<span class="c1">## rule1_Y_y means y axis for Y data in Rule 1</span>
<span class="n">rule1_Y_x</span><span class="p">,</span> <span class="n">rule1_Y_y</span> <span class="o">=</span> <span class="n">right_triangle_rules</span><span class="p">(</span><span class="n">C_min_y</span><span class="p">,</span> <span class="n">bases_y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">## and as above naming is applied</span>
<span class="n">rule2_Y_x</span><span class="p">,</span> <span class="n">rule2_Y_y</span> <span class="o">=</span> <span class="n">right_triangle_rules</span><span class="p">(</span><span class="n">C_max_y</span> <span class="o">-</span> <span class="n">bases_y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bases_y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>    

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rule1_Y_x</span><span class="p">,</span> <span class="n">rule1_Y_y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rule2_Y_x</span><span class="p">,</span> <span class="n">rule2_Y_y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">rule1_Y_x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">rule2_Y_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rule1_Y_x</span><span class="p">[::</span><span class="mi">8</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Rule 1. $Y$ is Zero&#39;</span><span class="p">,</span> <span class="s1">&#39;Rule 2. $Y$ is Small&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$\mu_Y$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$Y$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/main_97_0.png" src="../../_images/main_97_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## using rules we are going to find the output values</span>
<span class="k">def</span> <span class="nf">predict_FIS</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">rule_X</span><span class="p">,</span> <span class="n">rule_Y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    predict the output of the x using rule base fuzzy system</span>
<span class="sd">    Tsukamoto inference system is used</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    x_data : array_like</span>
<span class="sd">        the input values of the dataset</span>
<span class="sd">    rule_X : 2D array</span>
<span class="sd">        first dimension data range and for second dimension fuzzy membership values</span>
<span class="sd">    rule_Y : 2D array</span>
<span class="sd">        output data</span>
<span class="sd">        first dimension data range and for second dimension fuzzy membership values</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    y_predicted : array</span>
<span class="sd">        the float values representing the predicted output of x_data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1">## the initialization of the predicted values array</span>
    <span class="n">y_predicted</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">x_data</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1">## find the x fuzzy value for x input</span>
            <span class="n">x_fuzzy_value</span> <span class="o">=</span> <span class="n">rule_X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">rule_X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)]</span>

            <span class="c1">## if there was more than one value in x_fuzzy_value we know that they are close to each other</span>
            <span class="c1">## so just we use one of it</span>
            <span class="c1">## here we check if it was an array</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">x_fuzzy_value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">x_fuzzy_value</span> <span class="o">=</span> <span class="n">x_fuzzy_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                
            <span class="c1">## check which y fuzzy value is close the x fuzzy value and return the original y value</span>
            <span class="n">data_y_pred</span> <span class="o">=</span> <span class="n">rule_Y</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">x_fuzzy_value</span><span class="p">,</span> <span class="n">rule_Y</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)]</span>
            
            <span class="c1">## same as the if condition above</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">data_y_pred</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">data_y_pred</span> <span class="o">=</span> <span class="n">data_y_pred</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            
            <span class="c1">## append the predicted value</span>
            <span class="n">y_predicted</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_y_pred</span><span class="p">)</span>
        
        <span class="c1">## if the input x data didn&#39;t match the rules </span>
        <span class="c1">## then insert zero as predicted value</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">y_predicted</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">y_predicted</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##### First Rule. If `X` is Large then `Y` is Zero #####</span>

<span class="n">rule_A1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">rule1_X_x</span><span class="p">,</span> <span class="n">rule1_X_y</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">rule_B1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">rule1_Y_x</span><span class="p">,</span> <span class="n">rule1_Y_y</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_predicted_rule1</span> <span class="o">=</span> <span class="n">predict_FIS</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">rule_A1</span><span class="p">,</span> <span class="n">rule_B1</span><span class="p">)</span>

<span class="c1">## square error</span>
<span class="n">SE_Rule1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">y_predicted_rule1</span> <span class="o">-</span> <span class="n">dataset</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;First square error: </span><span class="si">{</span><span class="n">SE_Rule1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>First square error: 1.9797427163619779
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##### Second Rule. If `X` is Small then `Y` is Small #####</span>

<span class="n">rule_A2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">rule2_X_x</span><span class="p">,</span> <span class="n">rule2_X_y</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">rule_B2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">rule2_Y_x</span><span class="p">,</span> <span class="n">rule2_Y_y</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_predicted_rule2</span> <span class="o">=</span> <span class="n">predict_FIS</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">rule_A2</span><span class="p">,</span> <span class="n">rule_B2</span><span class="p">)</span>

<span class="c1">## print the square errors</span>
<span class="n">SE_Rule2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">y_predicted_rule2</span> <span class="o">-</span> <span class="n">dataset</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Second rule square error: </span><span class="si">{</span><span class="n">SE_Rule2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Second rule square error: 2.9863587688526496
</pre></div>
</div>
</div>
</div>
<p>The We will continue the first iteration to find the fitness values. For fitness values we will go through the equation below
\begin{equation}
f = A - \sum_i (y_i - y_i^{‘})^2
\end{equation}
<span class="math notranslate nohighlight">\(A\)</span> is one of our parameters and is chosen by user.</p>
<p>We would like to choose <span class="math notranslate nohighlight">\(A=100\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find_fitness_SE</span><span class="p">(</span><span class="n">SE</span><span class="p">,</span> <span class="n">A</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    find the fitness values using squared values</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    SE : float</span>
<span class="sd">        the squared value</span>
<span class="sd">    A : integer</span>
<span class="sd">        parameter chosen by user</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    f : float</span>
<span class="sd">        the fitness value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">A</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">SE</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">f</span>
<span class="k">def</span> <span class="nf">find_fitness</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_actual</span><span class="p">,</span> <span class="n">A</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    find fitness using predicted values and actual y values</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    y_pred : 1D array</span>
<span class="sd">        the predicted output values </span>
<span class="sd">    y : 1D array</span>
<span class="sd">        the actual output values</span>
<span class="sd">    A : integer</span>
<span class="sd">        parameter chosen by user</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    fitness : float</span>
<span class="sd">        the fitness value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">squared_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">y_pred</span> <span class="o">-</span> <span class="n">y_actual</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">fitness</span> <span class="o">=</span> <span class="n">find_fitness_SE</span><span class="p">(</span><span class="n">squared_error</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">fitness</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_rule1</span> <span class="o">=</span> <span class="n">find_fitness_SE</span><span class="p">(</span><span class="n">SE_Rule1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">f_rule2</span> <span class="o">=</span> <span class="n">find_fitness_SE</span><span class="p">(</span><span class="n">SE_Rule2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">f_rule1</span><span class="p">,</span> <span class="n">f_rule2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(8.020257283638022, 7.01364123114735)
</pre></div>
</div>
</div>
</div>
<p>We will create a row of table same as table 6.10a in Ross book.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## using pandas to create a beatifule table</span>
<span class="n">population_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">population_binary_representation</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;String&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">population_str</span><span class="p">],</span> 
        <span class="s1">&#39;Base 1 binary&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">population</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="s1">&#39;Base 2 binary&#39;</span> <span class="p">:[</span> <span class="n">population</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="s1">&#39;Base 3 binary&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">population</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
        <span class="s1">&#39;Base 4 binary&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">population</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span>
        <span class="s1">&#39;Base 1&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">bases_x</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="s1">&#39;Base 2&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">bases_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="s1">&#39;Base 3&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">bases_y</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="s1">&#39;Base 4&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">bases_y</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="sa">f</span><span class="s1">&#39;Rule 1, y</span><span class="se">\&#39;</span><span class="s1"> (x=</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">y_predicted_rule1</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="sa">f</span><span class="s1">&#39;Rule 1, y</span><span class="se">\&#39;</span><span class="s1"> (x=</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">y_predicted_rule1</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="sa">f</span><span class="s1">&#39;Rule 1, y</span><span class="se">\&#39;</span><span class="s1"> (x=</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">y_predicted_rule1</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
        <span class="sa">f</span><span class="s1">&#39;Rule 1, y</span><span class="se">\&#39;</span><span class="s1"> (x=</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">y_predicted_rule1</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span>
        <span class="sa">f</span><span class="s1">&#39;Rule 2, y</span><span class="se">\&#39;</span><span class="s1"> (x=</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">y_predicted_rule2</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="sa">f</span><span class="s1">&#39;Rule 2, y</span><span class="se">\&#39;</span><span class="s1"> (x=</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">y_predicted_rule2</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="sa">f</span><span class="s1">&#39;Rule 2, y</span><span class="se">\&#39;</span><span class="s1"> (x=</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">y_predicted_rule2</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
        <span class="sa">f</span><span class="s1">&#39;Rule 2, y</span><span class="se">\&#39;</span><span class="s1"> (x=</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">y_predicted_rule2</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span>
        <span class="s1">&#39;Rule 1 Fitness&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">f_rule1</span><span class="p">],</span>
        <span class="s1">&#39;Rule 2 Fitness&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">f_rule2</span><span class="p">],</span>        
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>String</th>
      <th>Base 1 binary</th>
      <th>Base 2 binary</th>
      <th>Base 3 binary</th>
      <th>Base 4 binary</th>
      <th>Base 1</th>
      <th>Base 2</th>
      <th>Base 3</th>
      <th>Base 4</th>
      <th>Rule 1, y' (x=0.0)</th>
      <th>Rule 1, y' (x=0.3)</th>
      <th>Rule 1, y' (x=0.6)</th>
      <th>Rule 1, y' (x=1.0)</th>
      <th>Rule 2, y' (x=0.0)</th>
      <th>Rule 2, y' (x=0.3)</th>
      <th>Rule 2, y' (x=0.6)</th>
      <th>Rule 2, y' (x=1.0)</th>
      <th>Rule 1 Fitness</th>
      <th>Rule 2 Fitness</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>['111110' '101101' '111110' '000010']</td>
      <td>62</td>
      <td>45</td>
      <td>62</td>
      <td>2</td>
      <td>98.412698</td>
      <td>71.428571</td>
      <td>0.984127</td>
      <td>0.031746</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.009941</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8.020257</td>
      <td>7.013641</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Until now we’ve done genetic algorithm for 4 population and one iteration. Let’s Make the code as a class and run everything inside it in order to use more population count and run more iterations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">genetic_fuzzy_tsukamoto</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    apply genetic algorithm on a fuzzy dataset and rules</span>
<span class="sd">    And also use tsukamoto inference system in it</span>
<span class="sd">    </span>
<span class="sd">    This is not a general class and is to capsulate all the works in Question 8 in order to use it in more than one iteration easily</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">bases_count</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
                 <span class="n">max_population_value</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
                 <span class="n">min_population_value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                 <span class="n">population_count</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
                 <span class="n">random_seed</span><span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        initilize the class</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        bases_count : positive integer</span>
<span class="sd">            the count for rules bases</span>
<span class="sd">            Since we have 2 rules and each has two values the default parameter is 4</span>
<span class="sd">        max_population_value : positive integer</span>
<span class="sd">            the maximum value that the population can have</span>
<span class="sd">            default_value is 64</span>
<span class="sd">        min_population_value : positive integer</span>
<span class="sd">            the minimum value that the population can have</span>
<span class="sd">            default_value is 0</span>
<span class="sd">        population_count : positive integer</span>
<span class="sd">            the value that can be set in population</span>
<span class="sd">        random_seed : positive integer</span>
<span class="sd">            to fix the random values can be reproduced</span>
<span class="sd">            default value is None, meaning values cannot be reproduced</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">bases_count</span> <span class="o">=</span> <span class="n">bases_count</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_population_value</span> <span class="o">=</span> <span class="n">max_population_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_population_value</span> <span class="o">=</span> <span class="n">min_population_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">population_count</span> <span class="o">=</span> <span class="n">population_count</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_seed</span> <span class="o">=</span> <span class="n">random_seed</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">population_binary_representation</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">population</span> <span class="o">=</span> <span class="kc">None</span>
        
        
        
        <span class="c1">## two rules will be applied for this question</span>
        <span class="c1">## `rule_A1` and `rlue_B1` are representive of the first rule (A1 then B1)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rule_A1</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rule_B1</span> <span class="o">=</span> <span class="kc">None</span>
        
        <span class="c1">## `rule_A2` and `rlue_B2` are representive of the second rule (A2 then B2)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rule_A2</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rule_B2</span> <span class="o">=</span> <span class="kc">None</span>
        
    
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">population</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        fit the parameters of the rules in one iteration </span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        X : 1D array_like</span>
<span class="sd">            input data with one feature </span>
<span class="sd">        Y : 1D array_like</span>
<span class="sd">            the output value for each X</span>
<span class="sd">        population : array</span>
<span class="sd">            fit the data on a predefined population</span>
<span class="sd">            default value is None meaning we are producing a random population</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">## if there was no population</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">population</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">population</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__init_population</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">population</span> <span class="o">=</span> <span class="n">population</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">population</span> <span class="o">=</span> <span class="n">population</span>
        
        <span class="c1">## the width of the population strings</span>
        <span class="n">population_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_population_value</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">population_binary_representation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_binary_representation_array</span><span class="p">(</span>
                <span class="n">population</span><span class="p">,</span> <span class="n">population_width</span>
            <span class="p">)</span>
        
        <span class="c1">## we can apply C values manually but we represent this way as an alternative</span>
        <span class="n">C_min_x</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[[</span><span class="s1">&#39;x&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">C_min_y</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[[</span><span class="s1">&#39;y&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">C_max_x</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[[</span><span class="s1">&#39;x&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">C_max_y</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[[</span><span class="s1">&#39;y&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="n">bases_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_C_value</span><span class="p">(</span><span class="n">population</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">population_width</span><span class="p">,</span> <span class="n">C_min_x</span><span class="p">,</span> <span class="n">C_max_x</span> <span class="p">)</span>
        <span class="n">bases_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_C_value</span><span class="p">(</span><span class="n">population</span><span class="p">[</span><span class="mi">2</span><span class="p">:],</span> <span class="n">population_width</span><span class="p">,</span> <span class="n">C_min_y</span><span class="p">,</span> <span class="n">C_max_y</span> <span class="p">)</span>
        
        <span class="c1">## rule1_X_x means the X data and x axis in Rule 1</span>
        <span class="c1">## rule1_X_y means the X data and y axis in Rule 1</span>
        <span class="n">rule1_X_x</span><span class="p">,</span> <span class="n">rule1_X_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__right_triangle_rules</span><span class="p">(</span><span class="n">C_min_x</span><span class="p">,</span> <span class="n">bases_x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1">## rule2_X_x means the X data and x axis in Rule 2</span>
        <span class="c1">## rule2_X_y means the X data and y axis in Rule 2</span>
        <span class="n">rule2_X_x</span><span class="p">,</span> <span class="n">rule2_X_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__right_triangle_rules</span><span class="p">(</span><span class="n">C_max_x</span> <span class="o">-</span> <span class="n">bases_x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bases_x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>   
        
        <span class="c1">## rule1_Y_x means x axis for Y data in Rule 1</span>
        <span class="c1">## rule1_Y_y means y axis for Y data in Rule 1</span>
        <span class="n">rule1_Y_x</span><span class="p">,</span> <span class="n">rule1_Y_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__right_triangle_rules</span><span class="p">(</span><span class="n">C_min_y</span><span class="p">,</span> <span class="n">bases_y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1">## and as above naming is applied</span>
        <span class="n">rule2_Y_x</span><span class="p">,</span> <span class="n">rule2_Y_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__right_triangle_rules</span><span class="p">(</span><span class="n">C_max_y</span> <span class="o">-</span> <span class="n">bases_y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bases_y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
        
        <span class="c1">## First and second rules </span>
        <span class="n">rule_A1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">rule1_X_x</span><span class="p">,</span> <span class="n">rule1_X_y</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">rule_B1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">rule1_Y_x</span><span class="p">,</span> <span class="n">rule1_Y_y</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="n">rule_A2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">rule2_X_x</span><span class="p">,</span> <span class="n">rule2_X_y</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">rule_B2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">rule2_Y_x</span><span class="p">,</span> <span class="n">rule2_Y_y</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="c1">## update the rules</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rule_A1</span> <span class="o">=</span> <span class="n">rule_A1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rule_B1</span> <span class="o">=</span> <span class="n">rule_B1</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">rule_A2</span> <span class="o">=</span> <span class="n">rule_A2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rule_B2</span> <span class="o">=</span> <span class="n">rule_B2</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">bases_x</span> <span class="o">=</span> <span class="n">bases_x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bases_y</span> <span class="o">=</span> <span class="n">bases_y</span>
        
        
        
    
    <span class="k">def</span> <span class="nf">__init_population</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        initialize population function</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        population : 1D array_like</span>
<span class="sd">            array of decimal values between max_random_value and min_random_value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">## initialize the population using random binary value</span>

        <span class="n">maximum_random_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_population_value</span>
        <span class="n">minimum_random_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_population_value</span>

        <span class="c1">## we need to specify four bases for our rules</span>
        <span class="n">bases_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bases_count</span>

        <span class="c1">## if random seed was given </span>
        <span class="c1">## set it</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_seed</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_seed</span><span class="p">)</span>

        <span class="n">population</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span>
            <span class="n">minimum_random_value</span><span class="p">,</span>
            <span class="n">maximum_random_value</span><span class="p">,</span>
            <span class="n">bases_count</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">population</span>
    
    <span class="k">def</span> <span class="nf">__get_binary_representation_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">binary_width</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the binary rerpresentation of an array</span>

<span class="sd">        Parameters:</span>
<span class="sd">        ------------</span>
<span class="sd">        x : array_like</span>
<span class="sd">            input decimal values</span>
<span class="sd">        binary_width : positive integer</span>
<span class="sd">            the value representive the count of the zeros and ones</span>
<span class="sd">            Important to set this with respect to `x` values</span>

<span class="sd">        Returns:</span>
<span class="sd">        ---------</span>
<span class="sd">        x_bin : string array</span>
<span class="sd">            binary string representation of decimal inputs </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1">## find the binary representation of the population</span>
        <span class="n">x_bin</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
            <span class="c1">## binary population</span>
            <span class="n">binary_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">binary_repr</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> 
                                        <span class="n">width</span><span class="o">=</span><span class="n">binary_width</span><span class="p">)</span>

            <span class="n">x_bin</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">binary_x</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">x_bin</span>
    
    <span class="k">def</span> <span class="nf">__get_C_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">c_min</span><span class="p">,</span> <span class="n">c_max</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find the value of `C` parameter for the genetic algorithm</span>

<span class="sd">        Parameters:</span>
<span class="sd">        ------------</span>
<span class="sd">        b : float</span>
<span class="sd">            decimal value representive of the input value of the data</span>
<span class="sd">        L : positive integer</span>
<span class="sd">            value representing the length of each string in genetic algorithm</span>
<span class="sd">        c_min : float or integer</span>
<span class="sd">            decimal value representive for the smallest value that is fitted in dataset</span>
<span class="sd">        c_max : float or integer</span>
<span class="sd">            decimal value representive for the biggest value that is fitted in dataset</span>

<span class="sd">        Returns:</span>
<span class="sd">        ---------</span>
<span class="sd">        C : float</span>
<span class="sd">            the parameter representive for the value of b</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">C</span> <span class="o">=</span> <span class="n">c_min</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">L</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">c_max</span> <span class="o">-</span> <span class="n">c_min</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">C</span>
    
    <span class="k">def</span> <span class="nf">__right_triangle_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_value</span><span class="p">,</span> <span class="n">base_width</span><span class="p">,</span> <span class="n">slope</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create right triangle membership functions for one rule</span>

<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        start_value : float</span>
<span class="sd">            the value that we are going to start the plot</span>
<span class="sd">        base_width : float</span>
<span class="sd">            the width of triangle&#39;s base</span>
<span class="sd">        slope : -1 or +1</span>
<span class="sd">            the slope of the triangle&#39;s hypotenuse</span>

<span class="sd">        Returns:</span>
<span class="sd">        ----------</span>
<span class="sd">        x : 1D array_like</span>
<span class="sd">            the x values representive the x coordinates of the membership function</span>
<span class="sd">        y : 1D array_like</span>
<span class="sd">            the y values representive the membership values</span>
<span class="sd">            Note: the membership function values are normalized.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Error value for slope, can be either +1 or -1!&#39;</span>

        <span class="c1">## the x values start at `start_value` and ends at `start_value + base_width`</span>
        <span class="n">end_value</span> <span class="o">=</span> <span class="n">start_value</span> <span class="o">+</span> <span class="n">base_width</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start_value</span><span class="p">,</span> <span class="n">end_value</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">base_width</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>

        <span class="c1">## finding y values via the slope</span>
        <span class="k">if</span> <span class="n">slope</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">base_width</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">end_value</span><span class="p">)</span>       
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">base_width</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">start_value</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>


    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        predict the output of the x using rule base fuzzy system</span>
<span class="sd">        Tsukamoto inference system is used</span>
<span class="sd">        The results will be for both 2 rules</span>

<span class="sd">        Parameters:</span>
<span class="sd">        ------------</span>
<span class="sd">        x_data : array_like</span>
<span class="sd">            the input values of the dataset</span>

<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        y1_predicted : array</span>
<span class="sd">            the float values representing the predicted output of x_data</span>
<span class="sd">            predicted values for rule number 1</span>
<span class="sd">        y2_predicted : array</span>
<span class="sd">            the float values representing the predicted output of x_data</span>
<span class="sd">            predicted values for rule number 2</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rule_A1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Error! First fit the model with data&quot;</span>
        
        <span class="c1">## predictions for both rules</span>
        <span class="n">y1_predicted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__prediction</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rule_A1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rule_B1</span><span class="p">)</span>
        <span class="n">y2_predicted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__prediction</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rule_A2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rule_B2</span><span class="p">)</span>

            
        <span class="k">return</span> <span class="n">y1_predicted</span><span class="p">,</span> <span class="n">y2_predicted</span>
    
    <span class="k">def</span> <span class="nf">__prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">rule_X</span><span class="p">,</span> <span class="n">rule_Y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        predict the output of the x using rule base fuzzy system</span>
<span class="sd">        Tsukamoto inference system is used</span>

<span class="sd">        Parameters:</span>
<span class="sd">        ------------</span>
<span class="sd">        x_data : array_like</span>
<span class="sd">            the input values of the dataset</span>
<span class="sd">        rule_X : 2D array</span>
<span class="sd">            first dimension data range and for second dimension fuzzy membership values</span>
<span class="sd">        rule_Y : 2D array</span>
<span class="sd">            output data</span>
<span class="sd">            first dimension data range and for second dimension fuzzy membership values</span>

<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        y_predicted : array</span>
<span class="sd">            the float values representing the predicted output of x_data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">## the initialization of the predicted values array</span>
        <span class="n">y_predicted</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">x_data</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1">## find the x fuzzy value for x input</span>
                <span class="n">x_fuzzy_value</span> <span class="o">=</span> <span class="n">rule_X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">rule_X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)]</span>

                <span class="c1">## if there was more than one value in x_fuzzy_value we know that they are close to each other</span>
                <span class="c1">## so just we use one of it</span>
                <span class="c1">## here we check if it was an array</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">x_fuzzy_value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">x_fuzzy_value</span> <span class="o">=</span> <span class="n">x_fuzzy_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                <span class="c1">## check which y fuzzy value is close the x fuzzy value and return the original y value</span>
                <span class="n">data_y_pred</span> <span class="o">=</span> <span class="n">rule_Y</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">x_fuzzy_value</span><span class="p">,</span> <span class="n">rule_Y</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)]</span>

                <span class="c1">## same as the if condition above</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">data_y_pred</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">data_y_pred</span> <span class="o">=</span> <span class="n">data_y_pred</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                <span class="c1">## append the predicted value</span>
                <span class="n">y_predicted</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_y_pred</span><span class="p">)</span>

            <span class="c1">## if the input x data didn&#39;t match the rules </span>
            <span class="c1">## then insert zero as predicted value</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">y_predicted</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">y_predicted</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GA_fuzzy</span> <span class="o">=</span> <span class="n">genetic_fuzzy_tsukamoto</span><span class="p">(</span><span class="n">random_seed</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>

<span class="n">GA_fuzzy</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">dataset</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="n">y_pred1</span><span class="p">,</span> <span class="n">y_pred2</span> <span class="o">=</span> <span class="n">GA_fuzzy</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> 

<span class="n">rule1_fitness</span> <span class="o">=</span> <span class="n">find_fitness</span><span class="p">(</span><span class="n">y_pred1</span><span class="p">,</span> <span class="n">dataset</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">rule2_fitness</span> <span class="o">=</span> <span class="n">find_fitness</span><span class="p">(</span><span class="n">y_pred2</span><span class="p">,</span> <span class="n">dataset</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">rule1_fitness</span><span class="p">,</span> <span class="n">rule2_fitness</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(8.020257283638022, 7.01364123114735)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.0, 0.0, 0.0, 0.009940676607343274, 0]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_table</span><span class="p">(</span><span class="n">class_instance</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">y_pred1</span><span class="p">,</span> <span class="n">y_pred2</span><span class="p">,</span> <span class="n">rule1_fitness</span><span class="p">,</span> <span class="n">rule2_fitness</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a table of the data </span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    class_instance : class instance</span>
<span class="sd">        an instance of `genetic_fuzzy_tsukamoto` class representing the values</span>
<span class="sd">    dataset : pandas dataframe</span>
<span class="sd">        contains input dataset</span>
<span class="sd">    y_pred1 : 1D array</span>
<span class="sd">        predicted values of input dataset using rule1</span>
<span class="sd">    y_pred2 : 1D array</span>
<span class="sd">        predicted values of input dataset using rule2</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    ---------</span>
<span class="sd">    table : pandas dataframe</span>
<span class="sd">        the table of data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">## using pandas to create a beatifule table</span>
    <span class="n">population_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">population_binary_representation</span><span class="p">)</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;String&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">class_instance</span><span class="o">.</span><span class="n">population_binary_representation</span><span class="p">)],</span> 
            <span class="s1">&#39;Base 1 binary&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">class_instance</span><span class="o">.</span><span class="n">population</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="s1">&#39;Base 2 binary&#39;</span> <span class="p">:[</span><span class="n">class_instance</span><span class="o">.</span><span class="n">population</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="s1">&#39;Base 3 binary&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">class_instance</span><span class="o">.</span><span class="n">population</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
            <span class="s1">&#39;Base 4 binary&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">class_instance</span><span class="o">.</span><span class="n">population</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span>
            <span class="s1">&#39;Base 1&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">class_instance</span><span class="o">.</span><span class="n">bases_x</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="s1">&#39;Base 2&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">class_instance</span><span class="o">.</span><span class="n">bases_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="s1">&#39;Base 3&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">class_instance</span><span class="o">.</span><span class="n">bases_y</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="s1">&#39;Base 4&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">class_instance</span><span class="o">.</span><span class="n">bases_y</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="sa">f</span><span class="s1">&#39;Rule 1, y</span><span class="se">\&#39;</span><span class="s1"> (x=</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">y_pred1</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="sa">f</span><span class="s1">&#39;Rule 1, y</span><span class="se">\&#39;</span><span class="s1"> (x=</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">y_pred1</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="sa">f</span><span class="s1">&#39;Rule 1, y</span><span class="se">\&#39;</span><span class="s1"> (x=</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">y_pred1</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
            <span class="sa">f</span><span class="s1">&#39;Rule 1, y</span><span class="se">\&#39;</span><span class="s1"> (x=</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">y_pred1</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span>
            <span class="sa">f</span><span class="s1">&#39;Rule 2, y</span><span class="se">\&#39;</span><span class="s1"> (x=</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">y_pred2</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="sa">f</span><span class="s1">&#39;Rule 2, y</span><span class="se">\&#39;</span><span class="s1"> (x=</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">y_pred2</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="sa">f</span><span class="s1">&#39;Rule 2, y</span><span class="se">\&#39;</span><span class="s1"> (x=</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">y_pred2</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
            <span class="sa">f</span><span class="s1">&#39;Rule 2, y</span><span class="se">\&#39;</span><span class="s1"> (x=</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">y_pred2</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span>
            <span class="s1">&#39;Rule 1 Fitness&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">rule1_fitness</span><span class="p">],</span>
            <span class="s1">&#39;Rule 2 Fitness&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">rule2_fitness</span><span class="p">],</span>        
        <span class="p">}</span>
    <span class="p">)</span>
    
    <span class="k">return</span> <span class="n">table</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table_row1</span> <span class="o">=</span> <span class="n">create_table</span><span class="p">(</span><span class="n">GA_fuzzy</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">y_pred1</span><span class="p">,</span> <span class="n">y_pred2</span><span class="p">,</span> <span class="n">rule1_fitness</span><span class="p">,</span> <span class="n">rule2_fitness</span><span class="p">)</span>
<span class="n">table_row1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>String</th>
      <th>Base 1 binary</th>
      <th>Base 2 binary</th>
      <th>Base 3 binary</th>
      <th>Base 4 binary</th>
      <th>Base 1</th>
      <th>Base 2</th>
      <th>Base 3</th>
      <th>Base 4</th>
      <th>Rule 1, y' (x=0.0)</th>
      <th>Rule 1, y' (x=0.3)</th>
      <th>Rule 1, y' (x=0.6)</th>
      <th>Rule 1, y' (x=1.0)</th>
      <th>Rule 2, y' (x=0.0)</th>
      <th>Rule 2, y' (x=0.3)</th>
      <th>Rule 2, y' (x=0.6)</th>
      <th>Rule 2, y' (x=1.0)</th>
      <th>Rule 1 Fitness</th>
      <th>Rule 2 Fitness</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>['111110', '101101', '111110', '000010']</td>
      <td>62</td>
      <td>45</td>
      <td>62</td>
      <td>2</td>
      <td>98.412698</td>
      <td>71.428571</td>
      <td>0.984127</td>
      <td>0.031746</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.009941</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8.020257</td>
      <td>7.013641</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">genetic_reproduction</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">population</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        reproduce samples class for genetic algorithm</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        ------------</span>
<span class="sd">        population : array of strings</span>
<span class="sd">            the population for now</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">population</span> <span class="o">=</span> <span class="n">population</span>
    
    <span class="k">def</span> <span class="nf">reproduce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mutation_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        produce new population using the given population</span>
<span class="sd">        the production is using cross over and mutation </span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        mutation_rate : float between 0 and 1</span>
<span class="sd">            this value represents that how many times the mutation is applied</span>
<span class="sd">            default value is 0.1 meaning for ten precent of the time mutation is applied</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        new_population : array of string</span>
<span class="sd">            the returned population is as length as the given population as input</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">population</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">population</span>
        <span class="c1">## initialize new population</span>
        <span class="n">new_population</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="n">population_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">population</span><span class="p">)</span>
        
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1">## while we didn&#39;t produce enough population continue the procedure</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">population_count</span><span class="p">:</span>
            <span class="c1">## find a value to use mutation or cross over </span>
            <span class="n">choice</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>

            <span class="c1">## apply mutation if choice is less than 0.1</span>
            <span class="k">if</span> <span class="n">choice</span> <span class="o">&lt;=</span> <span class="mf">0.1</span><span class="p">:</span>
                <span class="n">produced_sample</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mutation</span><span class="p">(</span><span class="n">population</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">new_population</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">produced_sample</span><span class="p">)</span>
                <span class="c1">## one new sample is produced so we increase the index with 1 value</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1">## apply a random division point</span>
                <span class="n">division_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">population</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                
                <span class="c1">## if there was just one sample available try mutation on one sample with itself</span>
                <span class="k">if</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">==</span> <span class="n">population_count</span><span class="p">:</span>
                    <span class="n">produced_samples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cross_over</span><span class="p">(</span><span class="n">population</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">population</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">division_point</span> <span class="p">)</span>
                    <span class="c1">## just append one of the produced samples</span>
                    <span class="n">new_population</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">produced_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">produced_samples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cross_over</span><span class="p">(</span><span class="n">population</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">population</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">division_point</span><span class="p">)</span>
                    <span class="n">new_population</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">produced_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">new_population</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">produced_samples</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                
                <span class="c1">## two new samples are produced so increase the index with 2 value</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span>
        
        <span class="k">return</span> <span class="n">new_population</span> 
                
        
    <span class="k">def</span> <span class="nf">__cross_over</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">,</span> <span class="n">division_point</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the cross over method on two samples of population </span>

<span class="sd">        Parameters:</span>
<span class="sd">        ------------</span>
<span class="sd">        sample1 : string </span>
<span class="sd">            a sample from the population in genetic algorithm</span>
<span class="sd">            having binary representation for example: `111000`</span>
<span class="sd">        sample2 : string </span>
<span class="sd">            a sample from the population in genetic algorithm</span>
<span class="sd">            having binary representation for example: `111000`  </span>
<span class="sd">        division_point : positive integer</span>
<span class="sd">            the point that the samples are splitted</span>

<span class="sd">        Returns:</span>
<span class="sd">        ---------</span>
<span class="sd">        new_sample1 : string</span>
<span class="sd">            the newly created sample using cross over</span>
<span class="sd">        new_sample2 : string</span>
<span class="sd">            the newly created sample using cross over</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">new_sample1</span> <span class="o">=</span> <span class="n">sample1</span><span class="p">[:</span><span class="n">division_point</span><span class="p">]</span> <span class="o">+</span> <span class="n">sample2</span><span class="p">[</span><span class="n">division_point</span><span class="p">:]</span>
        <span class="n">new_sample2</span> <span class="o">=</span> <span class="n">sample1</span><span class="p">[</span><span class="n">division_point</span><span class="p">:]</span> <span class="o">+</span> <span class="n">sample2</span><span class="p">[:</span><span class="n">division_point</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">new_sample1</span><span class="p">,</span> <span class="n">new_sample2</span>

    <span class="k">def</span> <span class="nf">__mutation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the mutation method on a samples of population to produce new samples </span>

<span class="sd">        Parameters:</span>
<span class="sd">        ------------</span>
<span class="sd">        sample1 : string </span>
<span class="sd">            a sample from the population in genetic algorithm</span>
<span class="sd">            having binary representation for example: `111000`</span>

<span class="sd">        Returns:</span>
<span class="sd">        ---------</span>
<span class="sd">        new_sample : string</span>
<span class="sd">            the newly created sample using cross over</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">## the point that mutation will be applied</span>
        <span class="n">mutation_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample1</span><span class="p">))</span>
        
        <span class="n">new_sample</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">new_sample</span> <span class="o">+=</span> <span class="n">sample1</span><span class="p">[:</span><span class="n">mutation_point</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="ow">not</span> <span class="nb">int</span><span class="p">(</span><span class="n">sample1</span><span class="p">[</span><span class="n">mutation_point</span><span class="p">])))</span> <span class="o">+</span> <span class="n">sample1</span><span class="p">[</span><span class="n">mutation_point</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>

        <span class="k">return</span> <span class="n">new_sample</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_population_str</span> <span class="o">=</span> <span class="n">genetic_reproduction</span><span class="p">(</span><span class="n">GA_fuzzy</span><span class="o">.</span><span class="n">population_binary_representation</span><span class="p">)</span><span class="o">.</span><span class="n">reproduce</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bin_to_decimal</span><span class="p">(</span><span class="n">binary_array</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    convert binary string array values to a decimal array</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    binary_array : 1D array_like</span>
<span class="sd">        an array that each value is representive of an binary string value</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    ---------</span>
<span class="sd">    decimal_array : 1D array_like</span>
<span class="sd">        array of decimal values representive of each binary input values</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">decimal_array</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">binary_value</span> <span class="ow">in</span> <span class="n">binary_array</span><span class="p">:</span>
        <span class="n">decimal_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">binary_value</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        
    <span class="k">return</span> <span class="n">decimal_array</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_population</span> <span class="o">=</span> <span class="n">bin_to_decimal</span><span class="p">(</span><span class="n">new_population_str</span><span class="p">)</span>
<span class="n">new_population</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">new_population</span><span class="p">)</span>
<span class="n">new_population</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([61, 58, 62, 32])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GA_fuzzy1</span> <span class="o">=</span> <span class="n">genetic_fuzzy_tsukamoto</span><span class="p">()</span>
<span class="n">GA_fuzzy1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">dataset</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">population</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">new_population</span><span class="p">))</span>

<span class="n">y_pred1</span><span class="p">,</span> <span class="n">y_pred2</span> <span class="o">=</span> <span class="n">GA_fuzzy1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> 

<span class="n">rule1_fitness</span> <span class="o">=</span> <span class="n">find_fitness</span><span class="p">(</span><span class="n">y_pred1</span><span class="p">,</span> <span class="n">dataset</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">rule2_fitness</span> <span class="o">=</span> <span class="n">find_fitness</span><span class="p">(</span><span class="n">y_pred2</span><span class="p">,</span> <span class="n">dataset</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">rule1_fitness</span><span class="p">,</span> <span class="n">rule2_fitness</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(8.020257283638022, 7.023235019801585)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table_row2</span> <span class="o">=</span> <span class="n">create_table</span><span class="p">(</span><span class="n">GA_fuzzy1</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">y_pred1</span><span class="p">,</span> <span class="n">y_pred2</span><span class="p">,</span> <span class="n">rule1_fitness</span><span class="p">,</span> <span class="n">rule2_fitness</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">table_row1</span><span class="p">,</span> <span class="n">table_row2</span><span class="p">),</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>String</th>
      <th>Base 1 binary</th>
      <th>Base 2 binary</th>
      <th>Base 3 binary</th>
      <th>Base 4 binary</th>
      <th>Base 1</th>
      <th>Base 2</th>
      <th>Base 3</th>
      <th>Base 4</th>
      <th>Rule 1, y' (x=0.0)</th>
      <th>Rule 1, y' (x=0.3)</th>
      <th>Rule 1, y' (x=0.6)</th>
      <th>Rule 1, y' (x=1.0)</th>
      <th>Rule 2, y' (x=0.0)</th>
      <th>Rule 2, y' (x=0.3)</th>
      <th>Rule 2, y' (x=0.6)</th>
      <th>Rule 2, y' (x=1.0)</th>
      <th>Rule 1 Fitness</th>
      <th>Rule 2 Fitness</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>['111110', '101101', '111110', '000010']</td>
      <td>62</td>
      <td>45</td>
      <td>62</td>
      <td>2</td>
      <td>98.412698</td>
      <td>71.428571</td>
      <td>0.984127</td>
      <td>0.031746</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.009941</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8.020257</td>
      <td>7.013641</td>
    </tr>
    <tr>
      <th>1</th>
      <td>['111101', '111010', '111110', '100000']</td>
      <td>61</td>
      <td>58</td>
      <td>62</td>
      <td>32</td>
      <td>96.825397</td>
      <td>92.063492</td>
      <td>0.984127</td>
      <td>0.507937</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.009941</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8.020257</td>
      <td>7.023235</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s do all the works and return the iteration one results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">iterate_genetic_algorithm</span><span class="p">(</span><span class="n">new_population_str</span><span class="p">,</span> <span class="n">iteration_count</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Iterate over all methods we&#39;ve been created</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    new_population_str : string array</span>
<span class="sd">        the initialized population</span>
<span class="sd">    iteration_count : positive integer</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    results_table : pandas dataframe</span>
<span class="sd">        the results for all values</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table_iteration</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">iteration_count</span><span class="p">):</span>
        <span class="n">GA_fuzzy</span> <span class="o">=</span> <span class="n">genetic_fuzzy_tsukamoto</span><span class="p">()</span>

        <span class="c1">## Reproduction phase</span>
        <span class="c1">## the last population is passed to create new population</span>
        <span class="n">new_population_str</span> <span class="o">=</span> <span class="n">genetic_reproduction</span><span class="p">(</span><span class="n">new_population_str</span><span class="p">)</span><span class="o">.</span><span class="n">reproduce</span><span class="p">()</span>
        <span class="n">new_population</span> <span class="o">=</span> <span class="n">bin_to_decimal</span><span class="p">(</span><span class="n">new_population_str</span><span class="p">)</span>
        <span class="n">new_population</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">new_population</span><span class="p">)</span>

        <span class="n">GA_fuzzy</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">dataset</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">population</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">new_population</span><span class="p">))</span>

        <span class="n">y_pred1</span><span class="p">,</span> <span class="n">y_pred2</span> <span class="o">=</span> <span class="n">GA_fuzzy</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> 

        <span class="n">rule1_fitness</span> <span class="o">=</span> <span class="n">find_fitness</span><span class="p">(</span><span class="n">y_pred1</span><span class="p">,</span> <span class="n">dataset</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">rule2_fitness</span> <span class="o">=</span> <span class="n">find_fitness</span><span class="p">(</span><span class="n">y_pred2</span><span class="p">,</span> <span class="n">dataset</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

        <span class="n">table</span> <span class="o">=</span> <span class="n">create_table</span><span class="p">(</span><span class="n">GA_fuzzy</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">y_pred1</span><span class="p">,</span> <span class="n">y_pred2</span><span class="p">,</span> <span class="n">rule1_fitness</span><span class="p">,</span> <span class="n">rule2_fitness</span><span class="p">)</span>   

        <span class="n">table_iteration</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    
    <span class="n">results_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">table_iteration</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">results_table</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## iteration count</span>
<span class="c1">## Note all the values of random!!!</span>
<span class="c1">## Can be different in the next run</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found values in </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> iterations&quot;</span><span class="p">)</span>
<span class="n">iterate_genetic_algorithm</span><span class="p">(</span><span class="n">new_population_str</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found values in 10 iterations
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>String</th>
      <th>Base 1 binary</th>
      <th>Base 2 binary</th>
      <th>Base 3 binary</th>
      <th>Base 4 binary</th>
      <th>Base 1</th>
      <th>Base 2</th>
      <th>Base 3</th>
      <th>Base 4</th>
      <th>Rule 1, y' (x=0.0)</th>
      <th>Rule 1, y' (x=0.3)</th>
      <th>Rule 1, y' (x=0.6)</th>
      <th>Rule 1, y' (x=1.0)</th>
      <th>Rule 2, y' (x=0.0)</th>
      <th>Rule 2, y' (x=0.3)</th>
      <th>Rule 2, y' (x=0.6)</th>
      <th>Rule 2, y' (x=1.0)</th>
      <th>Rule 1 Fitness</th>
      <th>Rule 2 Fitness</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>['111010', '110111', '110000', '111010']</td>
      <td>58</td>
      <td>55</td>
      <td>48</td>
      <td>58</td>
      <td>92.063492</td>
      <td>87.301587</td>
      <td>0.761905</td>
      <td>0.920635</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.007696</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8.018636</td>
      <td>7.031512</td>
    </tr>
    <tr>
      <th>1</th>
      <td>['110111', '110101', '110010', '001110']</td>
      <td>55</td>
      <td>53</td>
      <td>50</td>
      <td>14</td>
      <td>87.301587</td>
      <td>84.126984</td>
      <td>0.793651</td>
      <td>0.222222</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.008017</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8.018868</td>
      <td>7.017484</td>
    </tr>
    <tr>
      <th>2</th>
      <td>['110111', '111010', '110010', '000111']</td>
      <td>55</td>
      <td>58</td>
      <td>50</td>
      <td>7</td>
      <td>87.301587</td>
      <td>92.063492</td>
      <td>0.793651</td>
      <td>0.111111</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.008017</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8.018868</td>
      <td>7.015243</td>
    </tr>
    <tr>
      <th>3</th>
      <td>['110110', '111110', '110111', '010000']</td>
      <td>54</td>
      <td>62</td>
      <td>55</td>
      <td>16</td>
      <td>85.714286</td>
      <td>98.412698</td>
      <td>0.873016</td>
      <td>0.253968</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.008818</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8.019448</td>
      <td>7.018124</td>
    </tr>
    <tr>
      <th>4</th>
      <td>['111110', '101101', '110000', '011101']</td>
      <td>62</td>
      <td>45</td>
      <td>48</td>
      <td>29</td>
      <td>98.412698</td>
      <td>71.428571</td>
      <td>0.761905</td>
      <td>0.460317</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.007696</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8.018636</td>
      <td>7.022278</td>
    </tr>
    <tr>
      <th>5</th>
      <td>['111111', '010110', '111101', '000001']</td>
      <td>63</td>
      <td>22</td>
      <td>61</td>
      <td>1</td>
      <td>100.000000</td>
      <td>34.920635</td>
      <td>0.968254</td>
      <td>0.015873</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7.075484</td>
      <td>7.013321</td>
    </tr>
    <tr>
      <th>6</th>
      <td>['111110', '110101', '111101', '100000']</td>
      <td>62</td>
      <td>53</td>
      <td>61</td>
      <td>32</td>
      <td>98.412698</td>
      <td>84.126984</td>
      <td>0.968254</td>
      <td>0.507937</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.009780</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8.020142</td>
      <td>7.023235</td>
    </tr>
    <tr>
      <th>7</th>
      <td>['111101', '110110', '111100', '011000']</td>
      <td>61</td>
      <td>54</td>
      <td>60</td>
      <td>24</td>
      <td>96.825397</td>
      <td>85.714286</td>
      <td>0.952381</td>
      <td>0.380952</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.009620</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8.020026</td>
      <td>7.020681</td>
    </tr>
    <tr>
      <th>8</th>
      <td>['111110', '101110', '111000', '100011']</td>
      <td>62</td>
      <td>46</td>
      <td>56</td>
      <td>35</td>
      <td>98.412698</td>
      <td>73.015873</td>
      <td>0.888889</td>
      <td>0.555556</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.008979</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8.019564</td>
      <td>7.024192</td>
    </tr>
    <tr>
      <th>9</th>
      <td>['111110', '101011', '111001', '010001']</td>
      <td>62</td>
      <td>43</td>
      <td>57</td>
      <td>17</td>
      <td>98.412698</td>
      <td>68.253968</td>
      <td>0.904762</td>
      <td>0.269841</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.009139</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8.019679</td>
      <td>7.018444</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="possibility-distribution">
<h2>Possibility Distribution<a class="headerlink" href="#possibility-distribution" title="Permalink to this headline">#</a></h2>
<section id="q9">
<h3>Q9<a class="headerlink" href="#q9" title="Permalink to this headline">#</a></h3>
<p>Answer to the question 2 of chapter 8 Zimmerman book.</p>
<p>Define a probability distribution for “cars drive X mph on American freeways.”</p>
<p>If we define the mean to <span class="math notranslate nohighlight">\(80\)</span>, meaning that the most cars in freeways are driven with the speed of the <span class="math notranslate nohighlight">\(80 \; mph\)</span>, We can define a gaussian function with <span class="math notranslate nohighlight">\(\mu=80\)</span> for the probability and if the highest and lowest speeds are <span class="math notranslate nohighlight">\(100\)</span> and <span class="math notranslate nohighlight">\(60\)</span> miles per hour the <span class="math notranslate nohighlight">\(\sigma\)</span> can be <span class="math notranslate nohighlight">\(20\)</span>. So the Probability can be defined as
\begin{equation}
P(x) = \frac{1}{\sqrt{2\pi}\sigma} exp\Big(-\frac{1}{2}\big(\frac{x-80}{20}\big)^2\Big)
\end{equation}</p>
<p>And having the facts we’ve defined above for probability distribution we can define a triangular fuzzy number for the possiblity distribution.
\begin{equation}
\pi(x) = Triangular(80, 60, 100)
\end{equation}
Note that if we want to describe possiblity distribution with strong consistency principal we shouldn’t use the triangular density function above, and instead we could defind the function below
\begin{equation}
\pi(x) = \begin{cases}
0 \text{ For  }abs(x)=\inf  \
1 \text{ Otherwise}<br />
\end{cases}
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Let&#39;s just plot the distirbutions</span>

<span class="c1">##### Parameters</span>
<span class="n">Mu</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">20</span>

<span class="c1">############### Probability</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">Mu</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/main_125_0.png" src="../../_images/main_125_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">############# Possiblity distribution</span>
<span class="k">def</span> <span class="nf">triangular_fuzzy</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Mu</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Triangular fuzzy number</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    X : array</span>
<span class="sd">        the input range, can be an array of floating points</span>
<span class="sd">    Mu : integer or float</span>
<span class="sd">        the mean of the fuzzy number</span>
<span class="sd">    left : integer or float</span>
<span class="sd">        left expansion of the fuzzy number</span>
<span class="sd">    right : integer or float</span>
<span class="sd">        right expansion of the fuzzy number</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">## apply the left expansion on all the input</span>
    <span class="c1">## then using np.where apply the right expansion to the data</span>
    
    <span class="c1">## Apply the right expansion in the first condition</span>
    <span class="c1">## and apply the left expansion in the left condition</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X</span> <span class="o">&gt;</span> <span class="n">Mu</span><span class="p">,</span> <span class="p">(</span><span class="n">right</span> <span class="o">-</span> <span class="n">X</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">right</span> <span class="o">-</span> <span class="n">Mu</span><span class="p">)</span> <span class="p">,(</span><span class="n">X</span> <span class="o">-</span> <span class="n">left</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">Mu</span> <span class="o">-</span> <span class="n">left</span><span class="p">))</span>
    <span class="c1">## zero the negative numbers</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">Y</span>

<span class="c1">#### Parameters</span>
<span class="n">Mu</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">right</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">left</span> <span class="o">=</span> <span class="mi">60</span>

<span class="c1">#### Plot the possiblity distribution</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">triangular_fuzzy</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Mu</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/main_126_0.png" src="../../_images/main_126_0.png" />
</div>
</div>
</section>
<section id="q10">
<h3>Q10<a class="headerlink" href="#q10" title="Permalink to this headline">#</a></h3>
<p>Answer to the question 3 of chapter 8 of Zimmerman book.</p>
<p>To find the possibility measures we should find the suprimum of the minimum values of <span class="math notranslate nohighlight">\(\mu_{\tilde{A}}(u), \pi_x{u}\)</span></p>
<p>So because values for <span class="math notranslate nohighlight">\(A\)</span> given in range(6, 14) the answers can be
\begin{equation}
\pi_{\tilde{A}} = {(8, .6), (9, .8), (10, 1),(1 1, .8), (12, .6)}
\end{equation}
suprimum of the minimum values will be
\begin{equation}
\text{possiblity} = max(.6, 0.8, 1, 0.8, 0.6) = \color{green}1
\end{equation}
\begin{equation}
\pi_{\tilde{B}} = {(6, .4), (7, .5), (8, .6), (9, .8), (10,1),(11,.8), (12, .6), (13,.5), (14, .4)}
\end{equation}
And for <span class="math notranslate nohighlight">\(\tilde{B}\)</span>:
\begin{equation}
\text{possiblity} = max(0.4, 0.5, 0.6, 0.8, 1, 0.8, 0.6, 0.5, 0.4) = \color{green}1
\end{equation}</p>
<p>To discuss the values we can say that both possibilities for <span class="math notranslate nohighlight">\(\tilde{A}\)</span> and <span class="math notranslate nohighlight">\(\tilde{B}\)</span> is 1, meaning that they can happen with a probability.</p>
</section>
<section id="q11">
<h3>Q11<a class="headerlink" href="#q11" title="Permalink to this headline">#</a></h3>
<p>Answer to the question 4 of chapter 4 of the Zimmerman book.</p>
<p>Considering Example 4-1, we can answer find the probabilities of <span class="math notranslate nohighlight">\(A_1, A_2\)</span> and <span class="math notranslate nohighlight">\(A_3\)</span> via the equation below
\begin{equation}
\text{for }A \subseteq X \rightarrow \pi(A) = sup({x})
\end{equation}</p>
<p>And given <span class="math notranslate nohighlight">\(A_1, A_2\)</span> and <span class="math notranslate nohighlight">\(A_3\)</span> are as below:
\begin{equation}
A_1 = {1, 2, 3,4,5, 6} \
A_2={1, 5, 8, 9} \
A3={7, 9}
\end{equation}
We can find the possiblity of them in the equations below</p>
<p>\begin{equation}
\text{possiblity}(A_1) = \pi(A_1) = sup(\pi(1), \pi(2), \pi(3), \pi(4), \pi(5), \pi(6)) = sup{0, 0, 0, 0, 0.1, 0.5} = \color{green}{0.5} \
\text{possiblity}(A_2) = \pi(A_1) = sup(\pi(1), \pi(5), \pi(8), \pi(9)) = sup{0, 0.1, 1, 0.8} = \color{green}1 \
\text{possiblity}(A_3) = \pi(A_1) = sup(\pi(7), \pi(9)) = sup{0.8, 0.8} = \color{green}{0.8}
\end{equation}</p>
</section>
<section id="q12">
<h3>Q12<a class="headerlink" href="#q12" title="Permalink to this headline">#</a></h3>
<p>Answer the question 5 of chapter 8 in Zimmerman book.</p>
<p>To define the Yager’s probablity of a fuzzy event for question 10 here, we need to first have a look at what it was.
\begin{equation}
P(A_\alpha) = \frac{\sum_{x \in A_{\alpha}} P(x)}{\sum_{x \in A} P(x)}
\end{equation}
So we can find out that for any <span class="math notranslate nohighlight">\(\alpha\)</span> cut of the set <span class="math notranslate nohighlight">\(A\)</span>, we can compute its probability with summing the probabilities of each item in <span class="math notranslate nohighlight">\(\alpha\)</span> cut.</p>
<p>first to find the probability of each item having the universe set <span class="math notranslate nohighlight">\(A\)</span> in mind we can assign <span class="math notranslate nohighlight">\(\frac{1}{9}\)</span> for each item probability.
\begin{equation}
A = {6, 7, … , 13, 14}
\end{equation}
And having <span class="math notranslate nohighlight">\(\pi_{\tilde{A}}\)</span> in mind the question’s answer will goes as follows
<img alt="image.png" src="HW3/Answers/attachment:image.png" /></p>
<p>The complement of <span class="math notranslate nohighlight">\(\tilde{A}\)</span> will be
\begin{equation}
\pi_{C\tilde{A}} = {(6,1), (7,1), (8,0.4),(9, 0.2),(11, 0.2),(12, 0.4), (13, 1), (14, 1)}
\end{equation}
And so for <span class="math notranslate nohighlight">\(\pi_{C\tilde{A}}\)</span>
<img alt="image-2.png" src="HW3/Answers/attachment:image-2.png" /></p>
<p>So using yager’s probability definition, our answer will be the intersection of <span class="math notranslate nohighlight">\(\pi_{\tilde{A}}\)</span> and <span class="math notranslate nohighlight">\(\pi_{C\tilde{A}}\)</span></p>
<p>\begin{equation}
probability = \begin{cases}
0 \text{ for } w \in [0, \frac{4}{9}] \
0.6 \text{ for } w \in [\frac{4}{9}, \frac{5}{9}] \
0 \text{ for } w \in [\frac{5}{9}, 1] \
\end{cases}
\end{equation}</p>
</section>
</section>
<section id="extended-operations-on-fuzzy-numbers">
<h2>Extended operations on fuzzy numbers<a class="headerlink" href="#extended-operations-on-fuzzy-numbers" title="Permalink to this headline">#</a></h2>
<section id="q13">
<h3>Q13<a class="headerlink" href="#q13" title="Permalink to this headline">#</a></h3>
<p>Answer to the question 5, chapter 5 of Zimmerman book.</p>
<p>In this question using the values of <span class="math notranslate nohighlight">\(\tilde{M}, L(x), R(x)\)</span> in example 5-8, and having <span class="math notranslate nohighlight">\(\tilde{N} = (-4, .1, .6)_{LR}\)</span>, find the answer of <span class="math notranslate nohighlight">\(\tilde{M} \ominus \tilde{N}\)</span>.</p>
<p>First we recall the values in example 5-8.
\begin{equation}
L(x) = R(x) = \frac{1}{1+x^2} \
\tilde{M} = (1, .5, .8)_{LR}
\end{equation}</p>
<p>Then it’s easy to answer the question. We know from the extended subtraction that we first need to apply opposite of <span class="math notranslate nohighlight">\(\tilde{N}\)</span>, then use extended sum to answer the question. So
\begin{equation}
\tilde{M} \ominus \tilde{N} = \tilde{M} \oplus (\ominus \tilde{N}) \ (1, 0.5, 0.8)<em>{LR} \oplus (\ominus (-4, 0.1, 0.6)</em>{LR} \
(1, 0.5, 0.8)<em>{LR} \oplus (4, 0.6, 0.1)</em>{LR} \
\color{green}{(5, 1.1, 0.9)_{LR}}
\end{equation}</p>
</section>
<section id="q14">
<h3>Q14<a class="headerlink" href="#q14" title="Permalink to this headline">#</a></h3>
<p>Answer to the question 6, chapter 5 of Zimmerman book.</p>
<p>For this question, We need to find <span class="math notranslate nohighlight">\(\tilde{M} \odot \tilde{N}\)</span> and values for <span class="math notranslate nohighlight">\(\tilde{M}\)</span> and <span class="math notranslate nohighlight">\(\tilde{N}\)</span> are given in example 5-8 as below
\begin{equation}
L(x) = R(x) = \frac{1}{1+x^2} \
\tilde{M} = (1, .5, .8)<em>{LR} \
\tilde{N} = (2, .6, .2)</em>{LR}
\end{equation}</p>
<p>First we recall the equation for extended product
\begin{equation}
(n, \alpha, \beta) \odot (m, \gamma, \delta) = (mn, m\alpha + n\gamma, m\beta + n\delta)
\end{equation}
So using the answer can be written as
\begin{equation}
\tilde{M} \odot \tilde{N} = (1, 0.5, 0.8) \odot (2, 0.6, 0.2) = (2, 0.6 + 2 \times 0.5, 0.2 + 2 \times 0.8 ) = \color{green}{(2, 1.6, 1.8)}
\end{equation}</p>
</section>
</section>
<section id="fuzzy-clustering">
<h2>Fuzzy Clustering<a class="headerlink" href="#fuzzy-clustering" title="Permalink to this headline">#</a></h2>
<section id="q15">
<h3>Q15<a class="headerlink" href="#q15" title="Permalink to this headline">#</a></h3>
<p>Answer to the question 7, chapter 13 of Zimmerman book.</p>
<p>In this question, three possible fuzzy three-partitions for dataset <span class="math notranslate nohighlight">\(X=\{x_1, x_2, x_3, x_4, x_5\}\)</span> is requested.</p>
<p>The answer can be a matrix whose sum each column must be 1, So we can write 3 possible matrixes for fuzzy 3-partition clustering</p>
<p>\begin{equation}
U_1 = \begin{bmatrix}
0.3 &amp; 0.5 &amp; 0.1 &amp; 0.25 &amp; 0.07\
0.2 &amp; 0.1 &amp; 0.3 &amp; 0.35 &amp; 0.08\
0.5 &amp; 0.4 &amp; 0.6 &amp; 0.4 &amp; 0.85
\end{bmatrix},
U_2 = \begin{bmatrix}
0.1 &amp; 0.35 &amp; 0.15 &amp; 0.9 &amp; 0.45\
0.4 &amp; 0.15 &amp; 0.25 &amp; 0.05 &amp; 0.05\
0.5 &amp; 0.5 &amp; 0.6 &amp; 0.05 &amp; 0.05
\end{bmatrix}, \
U_3 = \begin{bmatrix}
0.4 &amp; 0.01 &amp; 0.12 &amp; 0.18 &amp; 0.55\
0.6 &amp; 0.9 &amp; 0.28 &amp; 0.17 &amp; 0.35\
0.0 &amp; 0.09 &amp; 0.6 &amp; 0.65 &amp; 0.1
\end{bmatrix}
\end{equation}</p>
</section>
<section id="q16">
<h3>Q16<a class="headerlink" href="#q16" title="Permalink to this headline">#</a></h3>
<p>Answer to the question 8, chapter 13 of Zimmerman book.</p>
<p>In this question, a set of <span class="math notranslate nohighlight">\(X\)</span> is given and (a) finding a 3 crisp partition that groups <span class="math notranslate nohighlight">\((1, 3)\)</span> and <span class="math notranslate nohighlight">\((10, 3)\)</span> together w.r.t minimizing Euclidean norm is requested. For (b) Doing the same procedure but minimizing the variance is needed.
\begin{equation}
X = {(1, 1), (1, 3), (10, 1), (10, 3), (5, 2)}
\end{equation}</p>
<section id="part-a">
<h4>Part a<a class="headerlink" href="#part-a" title="Permalink to this headline">#</a></h4>
<p>To group two set of values <span class="math notranslate nohighlight">\((1, 3)\)</span> and <span class="math notranslate nohighlight">\((10, 3)\)</span>, we cannot use euclidean distance measure for both features <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> because the euclidean distance of the values <span class="math notranslate nohighlight">\((1, 3)\)</span> and <span class="math notranslate nohighlight">\((10, 3)\)</span> is <span class="math notranslate nohighlight">\(\sqrt{(1-10)^2 + (3-3)^2} = 9\)</span>. So it’s a big value and the points cannot be grouped together.</p>
<p>If we notice the second feature subtraction we can find out that using just the second feature can help us group together <span class="math notranslate nohighlight">\((1, 3)\)</span> and <span class="math notranslate nohighlight">\((10, 3)\)</span> using euclidean distance. So the procedure will goes as below</p>
<p>Grouping of <span class="math notranslate nohighlight">\((1, 3)\)</span> and <span class="math notranslate nohighlight">\((10, 3)\)</span>
\begin{equation}
euclidean = \sqrt{(3-3)^2} = 0
\end{equation}
Grouping <span class="math notranslate nohighlight">\((1,1)\)</span> and <span class="math notranslate nohighlight">\((10, 1)\)</span>
\begin{equation}
euclidean = \sqrt{(1-1)^2} = 0
\end{equation}
And just <span class="math notranslate nohighlight">\((5, 2)\)</span> is left as another partition. So using the second feature can help us group the <span class="math notranslate nohighlight">\(X\)</span> set and represent us a perfect euclidean score of zero.</p>
</section>
<section id="part-b">
<h4>Part b<a class="headerlink" href="#part-b" title="Permalink to this headline">#</a></h4>
<p>To minimize the variance we must first see how variance equation works. Variance shows us the sum of differences from mean value, so the equation will be as below
\begin{equation}
Var(x) = \frac{\sum_{i=0}^{n} (x_i - \bar{x})^2}{n}
\end{equation}</p>
<p>So we first find the mean values as below
\begin{equation}
\bar{x_1} = \frac{1+1+10+10+5}{5} = 5.4 \
\bar{x_2} = \frac{1+3+1+3+2}{5} = 2
\end{equation}
So using the mean values of <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span>, we first try the method in part a to see does it works as before or not.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## the variance of (1, 3) and (10, 3)</span>
<span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="mf">5.4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">10</span><span class="o">-</span><span class="mf">5.4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="p">((</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(20.259999999999998, 1.0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## the variance of (1, 1) and (10, 1)</span>
<span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="mf">5.4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">10</span><span class="o">-</span><span class="mf">5.4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(20.259999999999998, 1.0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## the variance of (5, 2)</span>
<span class="p">((</span><span class="mi">5</span><span class="o">-</span><span class="mf">5.4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.16000000000000028, 0.0)
</pre></div>
</div>
</div>
</div>
<p>We’ve calculated the variances above and it is obvious that choosing the second features as in part a can minimize the variances for us. So we would stick to the solution in part (a)</p>
</section>
</section>
<section id="q17">
<h3>Q17<a class="headerlink" href="#q17" title="Permalink to this headline">#</a></h3>
<p>Answer the question 9, chapter 13 of Zimmerman book.</p>
<p>This question wants us to find the cluster validity of figures 13-11 and 13-12 using partition coefficient and partition entropy.</p>
<p>First we have to take a look at the figures 13-11 and 13-12.
<img alt="image.png" src="HW3/Answers/attachment:image.png" />
Then the equation for partition coefficient is
\begin{equation}
F(\tilde{U}, c) = \sum_{k=1}^{n} \sum_{i=1}^{c} \frac{(\mu_{ik})^2}{n}
\end{equation}
And partition entropy is
\begin{equation}
H(\tilde{U}, c) = -\frac{1}{n} \sum_{k=1}^{n} \sum_{i=1}^{c} \mu_{ik} log_e(\mu_{ik})
\end{equation}</p>
<p>For Figure 13-11 the partition coefficient and entropy will be calculated as
\begin{equation}
F(\tilde{U}, c) = \frac{(.99)^2 + (.99)^2 + 1^2 + 1^2 + 1^2 + 1^2 + (.99)^2 + (.47)^2 + (.01)^2 + (0)^2 + (0)^2 + (0)^2 + (.01)^2 + (.01)^2 + 0^2}{15}
\end{equation}
And the entropy will be as (we simplified the equation)
\begin{equation}
H(\tilde{U}, c) = -\frac{1}{15} \big(3 \times 0.99 log_e 0.99 + 4 \times 1 log_e 1 + 0.47 log_e 0.47 + 3 \times 0.01 log_e 0.01 + 4 \times 0 log_e 0\big)
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## the results is</span>
<span class="k">def</span> <span class="nf">power_2</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    find the power 2 of the value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">value</span> <span class="o">**</span> <span class="mi">2</span>

<span class="k">def</span> <span class="nf">entropy</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    return the entropy of the value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">value</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<span class="c1">## partition coefficient</span>
<span class="n">F</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">power_2</span><span class="p">(</span><span class="mf">0.99</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">power_2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">power_2</span><span class="p">(</span><span class="mf">0.47</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">power_2</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">F</span> <span class="o">/</span> <span class="mi">15</span>
<span class="c1">## entropy</span>
<span class="n">H</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">entropy</span><span class="p">(</span><span class="mf">0.99</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">entropy</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">entropy</span><span class="p">(</span><span class="mf">0.47</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">entropy</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">H</span> <span class="o">/</span> <span class="o">-</span><span class="mi">15</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Figure 13-11: Partition Coefficient&quot;</span><span class="p">,</span> <span class="n">F</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Figure 13-11: Partition Entropy&quot;</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Figure 13-11: Partition Coefficient 0.4774333333333333
Figure 13-11: Partition Entropy 0.03485768117834783
</pre></div>
</div>
</div>
</div>
<p>And for figure 13-12 the calculations are as</p>
<p>Partition Coefficient:
\begin{equation}
F(\tilde{U}, c) = \ \frac{(.86)^2 + (.97)^2 + (.86)^2 + (.94)^2 + (.99)^2 + (.94)^2 + (.88)^2 + (.50)^2 + (.12)^2 + (0.06)^2 + (0.01)^2 + (0.06)^2 + (.14)^2 + (.03)^2 + (0.14)^2}{15}
\end{equation}
Entropy:
\begin{equation}
H(\tilde{U}, c) = -\frac{1}{15} \big(2 \times 0.86 log_e 0.86 + 0.97 log_e 0.97 + 2 \times 0.94 log_e 0.94 + 0.99 log_e 0.99 + 0.88 log_e 0.88 + 0.50 log_e 0.50 + 0.12 log_e 0.12 + 2 \times 0.06 log_e 0.06 + 0.01 log_e 0.01 + 2 \times 0.14 log_e 0.14 + 0.03 log_e 0.03 \big)
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## partition coefficient</span>
<span class="c1">## because the equation was long we divided into three parts</span>
<span class="n">F</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">power_2</span><span class="p">(</span><span class="mf">0.86</span><span class="p">)</span> <span class="o">+</span> <span class="n">power_2</span><span class="p">(</span><span class="mf">0.97</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">power_2</span><span class="p">(</span><span class="mf">0.94</span><span class="p">)</span> <span class="o">+</span> <span class="n">power_2</span><span class="p">(</span><span class="mf">0.99</span><span class="p">)</span>
<span class="n">F</span> <span class="o">+=</span> <span class="n">power_2</span><span class="p">(</span><span class="mf">0.88</span><span class="p">)</span> <span class="o">+</span> <span class="n">power_2</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="n">power_2</span><span class="p">(</span><span class="mf">0.12</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">power_2</span><span class="p">(</span><span class="mf">0.06</span><span class="p">)</span> 
<span class="n">F</span> <span class="o">+=</span> <span class="n">power_2</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">power_2</span><span class="p">(</span><span class="mf">0.14</span><span class="p">)</span> <span class="o">+</span> <span class="n">power_2</span><span class="p">(</span><span class="mf">0.03</span><span class="p">)</span>

<span class="n">F</span> <span class="o">=</span> <span class="n">F</span> <span class="o">/</span> <span class="mi">15</span>

<span class="c1">## entropy</span>
<span class="c1">## it is divided in two parts to avoid long length expressions</span>
<span class="n">H</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">entropy</span><span class="p">(</span><span class="mf">0.86</span><span class="p">)</span> <span class="o">+</span> <span class="n">entropy</span><span class="p">(</span><span class="mf">0.97</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">entropy</span><span class="p">(</span><span class="mf">0.94</span><span class="p">)</span> <span class="o">+</span> <span class="n">entropy</span><span class="p">(</span><span class="mf">0.99</span><span class="p">)</span> <span class="o">+</span> <span class="n">entropy</span><span class="p">(</span><span class="mf">0.88</span><span class="p">)</span>
<span class="n">H</span> <span class="o">+=</span> <span class="n">entropy</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="n">entropy</span><span class="p">(</span><span class="mf">0.12</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">entropy</span><span class="p">(</span><span class="mf">0.06</span><span class="p">)</span> <span class="o">+</span> <span class="n">entropy</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">entropy</span><span class="p">(</span><span class="mf">0.14</span><span class="p">)</span> <span class="o">+</span> <span class="n">entropy</span><span class="p">(</span><span class="mf">0.03</span><span class="p">)</span> 
<span class="n">H</span> <span class="o">=</span> <span class="n">H</span> <span class="o">/</span> <span class="o">-</span><span class="mi">15</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Figure 13-12: Partition Coefficient&quot;</span><span class="p">,</span> <span class="n">F</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Figure 13-12: Partition Entropy&quot;</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Figure 13-12: Partition Coefficient 0.41690666666666665
Figure 13-12: Partition Entropy 0.1445402866144255
</pre></div>
</div>
</div>
</div>
</section>
<section id="q18">
<h3>Q18<a class="headerlink" href="#q18" title="Permalink to this headline">#</a></h3>
<p>Answer the question 1, chapter 10 of Ross book.</p>
<p>Using the table given below, And creating <span class="math notranslate nohighlight">\(\alpha\)</span>-cut<span class="math notranslate nohighlight">\(=0.5\)</span>, find how many clusters we could have? (Use max-min operator to first generate fuzzy similarity in <span class="math notranslate nohighlight">\(\tilde{R}\)</span>)
<img alt="image.png" src="HW3/Answers/attachment:image.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fuzzy_max_min</span><span class="p">(</span><span class="n">relation1</span><span class="p">,</span> <span class="n">relation2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    apply fuzzy max-min on two relations</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    relation1 : matrix_like</span>
<span class="sd">        the relation matrix containing fuzzy values</span>
<span class="sd">    relation2 : matrix_like</span>
<span class="sd">        the relation matrix containing fuzzy values</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    ---------</span>
<span class="sd">    result_relation : matrix_like</span>
<span class="sd">        the result of max-min composition on relation1 and relation2</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">relation1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">relation2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Error: Relation shapes must match!&#39;</span>
    
    <span class="c1">## initialize an empty array with None values</span>
    <span class="n">result_relation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">relation1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">relation2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">relation1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">relation2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">relation1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">relation2</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
            
            <span class="n">result_relation</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">result_relation</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="s1">&#39;.4 .1 .3 .8; .2 .7 .2 .1; .4 .2 .5 .1&#39;</span><span class="p">)</span>
<span class="n">table</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>matrix([[0.4, 0.1, 0.3, 0.8],
        [0.2, 0.7, 0.2, 0.1],
        [0.4, 0.2, 0.5, 0.1]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table_relation</span> <span class="o">=</span> <span class="n">fuzzy_max_min</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">table_relation</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.8, 0.2, 0.4],
       [0.2, 0.7, 0.2],
       [0.4, 0.2, 0.5]], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>So the <span class="math notranslate nohighlight">\(\tilde{R}\)</span> is now created and for <span class="math notranslate nohighlight">\(\alpha\)</span>-cut<span class="math notranslate nohighlight">\(=0.5\)</span> we can find the matrix below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## weak alpha cut is used</span>
<span class="p">(</span><span class="n">table_relation</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1, 0, 0],
       [0, 1, 0],
       [0, 0, 1]])
</pre></div>
</div>
</div>
</div>
<p>In the relation above we can see that three clusters are apeared and the patterns are divided into:
\begin{equation}
Cluster_1 = {a} \ Cluster_2 = {b} \ Cluster_3 = {c}
\end{equation}</p>
</section>
<section id="q19">
<h3>Q19<a class="headerlink" href="#q19" title="Permalink to this headline">#</a></h3>
<p>Answer question 4, chapter 10 of Ross book.</p>
<p>In this question 7 values are given and using a <span class="math notranslate nohighlight">\(\tilde{U}^0\)</span> as an initiali reference function, we need to apply a fuzzy clustering. (<span class="math notranslate nohighlight">\(m^{'}=2.0\)</span> and <span class="math notranslate nohighlight">\(\epsilon_L \leq 0.01\)</span>)</p>
<p>\begin{equation}
Dataset = \begin{pmatrix}
x_1 \ x_2
\end{pmatrix} =
\begin{pmatrix}
2 &amp; 9 &amp; 9 &amp; 5 &amp; 8 &amp; 5 &amp; 6 \
7&amp; 3 &amp; 4 &amp; 6 &amp; 8 &amp; 11 &amp; 1
\end{pmatrix} \
\tilde{U}^0 = \begin{pmatrix}
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \
1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 0
\end{pmatrix}
\end{equation}
Note: <span class="math notranslate nohighlight">\(\tilde{U}^0\)</span> given in the question was wrong (it has 8 columns), So because of that we changed it to 7 columns to match the dataset size.</p>
<p>First let’s recall the equations needed for this exercise.
\begin{equation}
V_i = \frac{1}{\sum_{k=1}^n \mu_{ik}^m} \sum_{k=1}^n \mu_{ik}^m x_k \text{,     For i=1,…, c} \
\mu_{ik} = \frac{\big(\frac{1}{||x_k - v_i||<em>G^2} \big)^{1/(m-1)}}{ \sum</em>{j=1}^c \big(\frac{1}{||x_k - v_j||_G^2} \big)^{1/(m-1)}} \text{,     For i=1,…, c; k=1,…, n}
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## we define the given U reference function as our initial mu_ik</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="s1">&#39;0 0 0 0 0 0 1; 1 1 1 1 1 1 0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="c1">## rename U to match the notation of Zimmerman book and our equations</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="s1">&#39;2 9 9 5 8 5 6; 7 3 4 6 8 11 1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

<span class="n">dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">U</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((7, 2), (7, 2))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## the parameter for C-means</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find_cluster_center</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find the cluster center for Fuzzy C-means or crisp K-means method</span>
<span class="sd">    depend on `mu` this function can either work for crisp K-means and Fuzzy C-means</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    mu : 2D array</span>
<span class="sd">        reference matrix that represents the membership of each data to each cluster</span>
<span class="sd">    x : 2D array</span>
<span class="sd">        input data that have x and y coordinates</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    ---------</span>
<span class="sd">    center : array</span>
<span class="sd">        center representing the center value for x and y data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
        <span class="n">division</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
        <span class="c1">## check the 1 divided by 0 values and change it to 0</span>
        <span class="n">division</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">division</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">division</span><span class="p">)</span>
        
        <span class="n">center</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mu</span><span class="p">)):</span>
            <span class="n">center</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        
        <span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">division</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span>
<span class="c1">#             center = np.multiply(division, np.sum(np.multiply(np.power(mu, m), x) ,axis=0))</span>

    <span class="k">return</span> <span class="n">center</span>

<span class="k">def</span> <span class="nf">find_reference_matrix</span><span class="p">(</span><span class="n">v_correspond</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find the cluster reference matrix for for Fuzzy C-means or crisp K-means method</span>
<span class="sd">    depend on `v` this function can either work for crisp K-means and Fuzzy C-means</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    v_correspond : array</span>
<span class="sd">        centers of belonging x to the cluster</span>
<span class="sd">    v : 2D array</span>
<span class="sd">        center of the all clusters</span>
<span class="sd">    x : 2D array</span>
<span class="sd">        input data that have x and y coordinates</span>
<span class="sd">    m : float bigger than 1</span>
<span class="sd">        parameter for the function</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    ---------</span>
<span class="sd">    reference_matrix : array</span>
<span class="sd">        newly created reference array for one data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">m</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;V cannot be less equal than 1!&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span> <span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
        <span class="c1">## above and below of the division</span>
        <span class="n">above</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">v_correspond</span><span class="p">)),</span> <span class="mi">1</span><span class="o">/</span> <span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="c1">## change infinity values to zero</span>
        <span class="n">above</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">above</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">above</span><span class="p">)</span>

        <span class="n">below</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">center</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
            <span class="n">below</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">center</span><span class="p">)),</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
            <span class="c1">## change infinity values to zero</span>
            <span class="n">below</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">below</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">below</span><span class="p">)</span>
 
        <span class="n">reference_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">above</span><span class="p">,</span> <span class="n">below</span><span class="p">)</span>
        <span class="c1">## change infinity values to zero</span>
        <span class="n">reference_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">reference_matrix</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">reference_matrix</span><span class="p">)</span>
        <span class="n">reference_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">reference_matrix</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">reference_matrix</span><span class="p">)</span>
        

    <span class="k">return</span> <span class="n">reference_matrix</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">update_CMeans_values</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    apply one iteration of fuzzy C-means updating center means and reference matrix</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    mu : 2D array</span>
<span class="sd">        reference matrix that represents the membership of each data to each cluster</span>
<span class="sd">    dataset : 2D array</span>
<span class="sd">        2D array representing x and y coordinates</span>
<span class="sd">    centers : 2D array</span>
<span class="sd">        array of centers representing the centers of clusters</span>
<span class="sd">    m : float bigger than 1</span>
<span class="sd">        parameter for the function</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    ---------</span>
<span class="sd">    mu_new : 2D array</span>
<span class="sd">        the updated reference values</span>
<span class="sd">    centers_new : 2D array</span>
<span class="sd">        the updated centers </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1">## initialization of variables</span>
    <span class="n">centers_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">centers</span><span class="p">)</span> 
    <span class="n">mu_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>
    
    <span class="c1">########### update the reference functions</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)):</span>
        <span class="n">mu_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">find_reference_matrix</span><span class="p">(</span><span class="n">centers_new</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">centers_new</span><span class="p">,</span> <span class="n">dataset</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">m</span><span class="p">)</span>
        <span class="n">mu_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">find_reference_matrix</span><span class="p">(</span><span class="n">centers_new</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">centers_new</span><span class="p">,</span> <span class="n">dataset</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">m</span><span class="p">)</span>
        
        
    <span class="c1">########## update the centers</span>

    
    <span class="c1">###### The commented code is for crisp K-means, we need the Fuzzy C-means</span>
<span class="c1">#     ## thoes belong to cluster 1</span>
<span class="c1">#     cluster1_mu = mu[np.array(mu[:, 0] &lt; mu[:, 1]).flatten()]</span>
<span class="c1">#     ## and thoes belong to cluster number 0</span>
<span class="c1">#     cluster0_mu = mu[np.array(mu[:, 0] &gt; mu[:, 1]).flatten()]</span>

<span class="c1">#     ## data that belongs to cluster 1</span>
<span class="c1">#     cluster1_data = dataset[np.array(mu[:, 0] &lt; mu[:, 1]).flatten()]</span>

<span class="c1">#     ## data that belongs to cluster 0</span>
<span class="c1">#     cluster0_data = dataset[np.array(mu[:, 0] &gt; mu[:, 1]).flatten()]     </span>

<span class="c1">#     ## update the centers using the new membership function</span>
<span class="c1">#     center1 = find_cluster_center(cluster1_mu, cluster1_data, m)</span>
<span class="c1">#     center2 = find_cluster_center(cluster0_mu, cluster0_data, m)</span>
    
    <span class="c1">## using C-means</span>
    <span class="n">center1</span> <span class="o">=</span> <span class="n">find_cluster_center</span><span class="p">(</span><span class="n">mu</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="n">center0</span> <span class="o">=</span> <span class="n">find_cluster_center</span><span class="p">(</span><span class="n">mu</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    
    <span class="n">centers_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">center0</span><span class="p">,</span> <span class="n">center1</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">mu_new</span><span class="p">,</span> <span class="n">centers_new</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fit_Cmeans</span><span class="p">(</span><span class="n">dataset</span> <span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">centers</span> <span class="p">,</span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fit on data iteratively using C-Means method</span>
<span class="sd">    </span>
<span class="sd">    Parametrs:</span>
<span class="sd">    -----------</span>
<span class="sd">    dataset : 2D array</span>
<span class="sd">        set of x and y data coordinates</span>
<span class="sd">    mu : 2D array</span>
<span class="sd">        reference matrix that represents the membership of each data to each cluster</span>
<span class="sd">    centers : 2D array</span>
<span class="sd">        array of centers representing the centers of clusters</span>
<span class="sd">    epsilon : float</span>
<span class="sd">        when to stop the iterations, where values are changing less than `epsilon`</span>
<span class="sd">        default is `0.01`</span>
<span class="sd">    m : float bigger than 1</span>
<span class="sd">        parameter for the function</span>
<span class="sd">        default value is `2`</span>
<span class="sd">    max_iter : positive integer</span>
<span class="sd">        if the method doesn&#39;t converge, how many iterations it should iterate</span>
<span class="sd">        default is `1000`</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    ---------</span>
<span class="sd">    new_mu : 2D array</span>
<span class="sd">        new updated reference matrix</span>
<span class="sd">    new_centers : 2D array</span>
<span class="sd">        new updated center values</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">new_centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">centers</span><span class="p">)</span>
    <span class="n">new_mu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>
    
    <span class="c1">## set to be the default condition</span>
    <span class="n">condition</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="c1">## set to have the count of iterations</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">condition</span><span class="p">:</span>
        <span class="c1">## save the last iteration values to be able to find how values are changing</span>
        <span class="n">old_mu</span><span class="p">,</span> <span class="n">old_centers</span> <span class="o">=</span> <span class="n">new_mu</span><span class="p">,</span> <span class="n">new_centers</span>
        <span class="c1">## then update</span>
        <span class="n">new_mu</span><span class="p">,</span> <span class="n">new_centers</span> <span class="o">=</span> <span class="n">update_CMeans_values</span><span class="p">(</span><span class="n">new_mu</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">new_centers</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
        
        <span class="n">measure1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">new_mu</span> <span class="o">-</span> <span class="n">old_mu</span><span class="p">)</span>
        <span class="n">measure2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">new_centers</span> <span class="o">-</span> <span class="n">old_centers</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="p">((</span><span class="n">measure1</span> <span class="o">+</span> <span class="n">measure2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Method converged to a local optimum in </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> iterations!&quot;</span><span class="p">)</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">max_iter</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Method coudn&#39;t converge to a local optimum and ended with </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> iterations!&quot;</span><span class="p">)</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
    
    <span class="k">return</span> <span class="n">new_mu</span><span class="p">,</span> <span class="n">new_centers</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">center0</span> <span class="o">=</span> <span class="n">find_cluster_center</span><span class="p">(</span><span class="n">mu</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="n">center1</span> <span class="o">=</span> <span class="n">find_cluster_center</span><span class="p">(</span><span class="n">mu</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>

<span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">center0</span><span class="p">,</span> <span class="n">center1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_Cmeans</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Method converged to a local optimum in 1 iterations!
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([[0.37691298, 0.62308705],
        [0.5496257 , 0.45037428],
        [0.46281585, 0.5371842 ],
        [0.21830392, 0.7816961 ],
        [0.23547374, 0.76452625],
        [0.31834063, 0.6816594 ],
        [0.        , 1.        ]], dtype=float32),
 matrix([[6.33333333, 6.5       ],
         [6.        , 1.        ]]))
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./HW3\Answers"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../../HW1/main.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Homework #1</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Mohammad Amin Dadgar<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>